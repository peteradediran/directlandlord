<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DirectLandlord - Rent Apartments in Lagos Direct from Landlords | No Agent Fees</title>
    <meta name="description" content="Find rental properties directly from verified landlords in Nigeria. No agents, no commissions. Browse apartments, houses in Lagos, Abuja, Port Harcourt. WhatsApp landlords directly.">
    <meta name="keywords" content="rent apartment Lagos, houses for rent Nigeria, property for rent Abuja, landlord direct contact, no agent commission, verified landlords Nigeria, rent apartment Victoria Island, affordable houses Ikeja">
    <meta name="author" content="DirectLandlord">
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="DirectLandlord - Rent Direct from Landlords | No Agent Fees">
    <meta property="og:description" content="Find rental properties directly from verified landlords in Nigeria. No agents, no commissions. WhatsApp landlords directly.">
    <meta property="og:image" content="https://directlandlord.com/images/og-image.jpg">
    <meta property="og:url" content="https://directlandlord.com">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="DirectLandlord">
    <meta property="og:locale" content="en_NG">
    
    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="DirectLandlord - Rent Direct from Landlords">
    <meta name="twitter:description" content="Find rental properties directly from verified landlords. No agents, no commissions.">
    <meta name="twitter:image" content="https://directlandlord.com/images/twitter-card.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://directlandlord.com">
    
    <!-- Favicon -->
    <!-- Favicon SVG Data URL (No file needed) -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjQgMjRDMjQgMjIuMzQzMSAyNS4zNDMxIDIxIDI3IDIxSDM3QzM4LjY1NjkgMjEgNDAgMjIuMzQzMSA0MCAyNFY0MEgyNFYyNFoiIGZpbGw9IiM3QzNBRUQiLz4KICA8cGF0aCBkPSJNMzIgMTZMMjIgMjRINDJMMzIgMTZaIiBmaWxsPSIjOEI1Q0Y2Ii8+CiAgPGNpcmNsZSBjeD0iNDgiIGN5PSIyMCIgcj0iNiIgZmlsbD0iIzEwQjk4MSIvPgogIDxwYXRoIGQ9Ik00NSAyMEw0NyAyMkw1MSAxOCIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K">
    
    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "RealEstateAgent",
      "name": "DirectLandlord",
      "description": "Connect directly with landlords to rent properties in Nigeria. No agents, no commissions.",
      "url": "https://directlandlord.com",
      "logo": "https://directlandlord.com/logo.png",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "NG",
        "addressRegion": "Lagos"
      },
      "serviceArea": {
        "@type": "Place",
        "name": "Nigeria"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "customer service",
        "areaServed": "NG"
      },
      "sameAs": [
        "https://facebook.com/directlandlord",
        "https://twitter.com/directlandlord",
        "https://instagram.com/directlandlord"
      ]
    }
    </script>
    
    <!-- Additional Schema for Homepage -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "DirectLandlord",
      "url": "https://directlandlord.com",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://directlandlord.com/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    
    <!-- Robots -->
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    
    <!-- Geo Tags -->
    <meta name="geo.region" content="NG-LA">
    <meta name="geo.placename" content="Lagos">
    <meta name="geo.position" content="6.524379;3.379206">
    <meta name="ICBM" content="6.524379, 3.379206">
    
    <style>
        :root {
            --primary: #7C3AED;
            --primary-dark: #6D28D9;
            --primary-light: #8B5CF6;
            --secondary: #10B981;
            --accent: #F59E0B;
            --danger: #EF4444;
            --warning: #FBBF24;
            --success: #10B981;
            --info: #3B82F6;
            
            --dark: #1F2937;
            --dark-2: #374151;
            --dark-3: #4B5563;
            --light: #F9FAFB;
            --light-2: #F3F4F6;
            --light-3: #E5E7EB;
            
            --card-bg: #FFFFFF;
            --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            --card-shadow-hover: 0 10px 25px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --border-radius-sm: 8px;
            --border-radius-lg: 16px;
            
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s ease;
            
            --header-height: 72px;
            --max-width: 1280px;
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            --gradient-success: linear-gradient(135deg, var(--success) 0%, #34D399 100%);
            --gradient-warning: linear-gradient(135deg, var(--warning) 0%, #FBBF24 100%);
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }



        /* Switch Toggle */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--light-3);
            transition: var(--transition);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition);
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:focus + .slider {
            box-shadow: 0 0 1px var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        /* Settings Forms */
        .settings-form {
            display: block;
        }

        .settings-form.hidden {
            display: none;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            scroll-padding-top: calc(var(--header-height) + 20px);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Manrope', sans-serif;
            font-weight: 700;
            line-height: 1.2;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            font-family: 'Inter', sans-serif;
            cursor: pointer;
        }

        input, select, textarea {
            font-family: 'Inter', sans-serif;
        }

        /* Container */
        .container {
            width: 100%;
            max-width: var(--max-width);
            margin: 0 auto;
            padding: 0 24px;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--light-3);
            z-index: 1000;
            transition: var(--transition);
        }

        .header.scrolled {
            box-shadow: var(--shadow-md);
        }

        .nav {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 32px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: 'Manrope', sans-serif;
            font-weight: 800;
            font-size: 24px;
            padding: 8px 0;
            color: var(--primary);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .nav-links {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-left: auto;
        }

        .nav-link {
            padding: 10px 16px;
            font-weight: 500;
            color: var(--dark-3);
            border-radius: var(--border-radius-sm);
            transition: var(--transition-fast);
            position: relative;
        }

        .nav-link:hover {
            color: var(--primary);
            background: var(--light-2);
        }

        .nav-link.active {
            color: var(--primary);
            font-weight: 600;
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 16px;
            right: 16px;
            height: 2px;
            background: var(--primary);
            border-radius: 1px;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 20px;
            color: var(--dark-3);
            padding: 8px;
            border-radius: var(--border-radius-sm);
        }

        .mobile-menu-btn:hover {
            background: var(--light-2);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            font-weight: 600;
            font-size: 15px;
            border: none;
            outline: none;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            white-space: nowrap;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover:not(:disabled)::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(124, 58, 237, 0.4);
        }

        .btn-secondary {
            background: var(--gradient-success);
            color: white;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .btn-secondary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover:not(:disabled) {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .btn-danger:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 14px;
        }

        .btn-lg {
            padding: 16px 32px;
            font-size: 16px;
        }

        .btn-icon {
            padding: 12px;
            width: 44px;
            height: 44px;
        }

        /* Hero Section */
        .hero {
            padding: calc(var(--header-height) + 80px) 0 100px;
            background: linear-gradient(135deg, #F9FAFB 0%, #F3F4F6 100%);
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(124, 58, 237, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
        }

        .hero-title {
            font-size: 64px;
            font-weight: 800;
            margin-bottom: 24px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.1;
        }

        .hero-subtitle {
            font-size: 20px;
            color: var(--dark-3);
            margin-bottom: 40px;
            line-height: 1.6;
            max-width: 600px;
        }

        .hero-stats {
            display: flex;
            gap: 48px;
            margin-top: 60px;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 48px;
            font-weight: 800;
            color: var(--primary);
            line-height: 1;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 16px;
            color: var(--dark-3);
            font-weight: 500;
        }

        /* Search Section */
        .search-section {
            margin-top: 40px;
            position: relative;
            z-index: 100;
        }

        .search-card {
            background: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 40px;
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--light-3);
        }

        .search-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 32px;
            text-align: center;
        }

        .search-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        /* Forms */
        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-2);
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--light-3);
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: var(--transition-fast);
            background: var(--card-bg);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }

        .form-control.error {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.02);
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%236B7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 20px;
            padding-right: 48px;
        }

        .error-message {
            color: var(--danger);
            font-size: 13px;
            margin-top: 6px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        /* Sections */
        .section {
            padding: 100px 0;
        }

        .section-title {
            font-size: 48px;
            font-weight: 800;
            color: var(--dark);
            text-align: center;
            margin-bottom: 16px;
        }

        .section-subtitle {
            font-size: 18px;
            color: var(--dark-3);
            text-align: center;
            max-width: 600px;
            margin: 0 auto 60px;
            line-height: 1.6;
        }

        /* Properties Grid */
        .properties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }

        .property-card {
            background: var(--card-bg);
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--light-3);
            transition: var(--transition);
            position: relative;
        }

        .property-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }

        .property-badge {
            position: absolute;
            top: 16px;
            left: 16px;
            z-index: 2;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: white;
            backdrop-filter: blur(4px);
            background: rgba(0, 0, 0, 0.6);
        }

        .badge-featured {
            background: rgba(239, 68, 68, 0.9);
        }

        .badge-verified {
            background: rgba(16, 185, 129, 0.9);
        }

        .badge-new {
            background: rgba(124, 58, 237, 0.9);
        }

        .property-image-container {
            position: relative;
            width: 100%;
            height: 240px;
            overflow: hidden;
            background: var(--light-2);
        }

        .property-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .property-card:hover .property-image {
            transform: scale(1.05);
        }

        .property-content {
            padding: 24px;
        }

        .property-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .property-price {
            font-size: 28px;
            font-weight: 800;
            color: var(--primary);
        }

        .property-price span {
            font-size: 14px;
            color: var(--dark-3);
            font-weight: 500;
        }

        .property-favorite {
            background: none;
            border: none;
            color: var(--light-3);
            cursor: pointer;
            transition: var(--transition);
            padding: 8px;
            font-size: 20px;
        }

        .property-favorite:hover {
            color: var(--danger);
            transform: scale(1.2);
        }

        .property-favorite.active {
            color: var(--danger);
        }

        .property-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .property-location {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--dark-3);
            margin-bottom: 16px;
            font-size: 14px;
        }

        .property-description {
            color: var(--dark-3);
            font-size: 15px;
            margin-bottom: 20px;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .property-features {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--light-3);
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: var(--dark-3);
        }

        .feature i {
            color: var(--primary);
        }

        .property-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .property-date {
            font-size: 13px;
            color: var(--dark-3);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            grid-column: 1 / -1;
        }

        .empty-state i {
            font-size: 64px;
            color: var(--light-3);
            margin-bottom: 24px;
        }

        .empty-state h3 {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-2);
            margin-bottom: 12px;
        }

        .empty-state p {
            color: var(--dark-3);
            max-width: 400px;
            margin: 0 auto 24px;
            line-height: 1.6;
        }

        /* Load More */
        .load-more {
            text-align: center;
            margin-top: 40px;
        }

        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            padding: 20px;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: var(--border-radius-lg);
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(30px);
            transition: var(--transition);
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--light-3);
        }

        .modal.show .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            padding: 32px;
            border-bottom: 1px solid var(--light-3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: var(--card-bg);
            z-index: 1;
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        }

        .modal-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--dark);
        }

        .modal-close {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light-2);
            border: none;
            border-radius: var(--border-radius);
            color: var(--dark-3);
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover {
            background: var(--danger);
            color: white;
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 32px;
        }

        /* Auth Forms */
        .auth-tabs {
            display: flex;
            gap: 1px;
            background: var(--light-3);
            border-radius: var(--border-radius);
            margin-bottom: 32px;
            overflow: hidden;
        }

        .auth-tab {
            flex: 1;
            padding: 16px;
            background: var(--card-bg);
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: var(--dark-3);
            cursor: pointer;
            transition: var(--transition);
        }

        .auth-tab.active {
            background: var(--primary);
            color: white;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        /* Image Upload */
        .image-upload {
            border: 2px dashed var(--light-3);
            border-radius: var(--border-radius);
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: var(--light);
        }

        .image-upload:hover {
            border-color: var(--primary);
            background: var(--light-2);
        }

        .image-upload i {
            font-size: 48px;
            color: var(--light-3);
            margin-bottom: 16px;
        }

        .image-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }

        .preview-image {
            position: relative;
            border-radius: var(--border-radius);
            overflow: hidden;
            height: 120px;
            background: var(--light-2);
        }

        .preview-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .remove-image {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 28px;
            height: 28px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            transition: var(--transition);
        }

        .remove-image:hover {
            background: var(--danger);
            transform: scale(1.1);
        }

        /* User Menu */
        .user-menu {
            position: relative;
        }

        .user-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            background: var(--light-2);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .user-btn:hover {
            background: var(--light-3);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
        }

        .user-name {
            font-weight: 600;
            color: var(--dark);
            font-size: 15px;
        }

        .dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-xl);
            min-width: 240px;
            display: none;
            z-index: 1001;
            overflow: hidden;
            border: 1px solid var(--light-3);
        }

        .dropdown.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            color: var(--dark-2);
            transition: var(--transition);
            border-bottom: 1px solid var(--light-3);
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item:hover {
            background: var(--light-2);
            color: var(--primary);
        }

        .dropdown-item i {
            width: 20px;
            text-align: center;
            color: var(--dark-3);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 2001;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .toast {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-xl);
            display: flex;
            align-items: center;
            gap: 16px;
            max-width: 400px;
            transform: translateX(100%);
            opacity: 0;
            animation: slideInRight 0.3s ease forwards;
            border-left: 4px solid var(--primary);
        }

        @keyframes slideInRight {
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast.success {
            border-left-color: var(--success);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .toast.info {
            border-left-color: var(--info);
        }

        .toast-icon {
            font-size: 24px;
        }

        .toast.success .toast-icon {
            color: var(--success);
        }

        .toast.error .toast-icon {
            color: var(--danger);
        }

        .toast.warning .toast-icon {
            color: var(--warning);
        }

        .toast.info .toast-icon {
            color: var(--info);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 4px;
        }

        .toast-message {
            color: var(--dark-3);
            font-size: 14px;
            line-height: 1.4;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--dark-3);
            cursor: pointer;
            padding: 4px;
            font-size: 16px;
        }

        /* Loader */
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--light-3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Footer */
        .footer {
            background: var(--dark);
            color: white;
            padding: 80px 0 40px;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 48px;
            margin-bottom: 48px;
        }

        .footer-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 24px;
            color: white;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: #9CA3AF;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: white;
            padding-left: 4px;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #9CA3AF;
            font-size: 14px;
        }

        /* Progress Bar for Image Upload */
        .upload-progress {
            width: 100%;
            height: 4px;
            background: var(--light-3);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 8px;
            display: none;
        }

        .upload-progress.show {
            display: block;
        }

        .upload-progress-bar {
            height: 100%;
            background: var(--primary);
            border-radius: 2px;
            transition: width 0.3s ease;
            width: 0%;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .hero-title {
                font-size: 48px;
            }
            
            .section-title {
                font-size: 40px;
            }
            
            .properties-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .hero-title {
                font-size: 36px;
            }
            
            .hero-subtitle {
                font-size: 18px;
            }
            
            .search-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .properties-grid {
                grid-template-columns: 1fr;
            }
            
            .hero-stats {
                flex-direction: column;
                gap: 32px;
            }
            
            .modal-content {
                margin: 0;
                border-radius: 0;
                max-height: 100vh;
            }
            
            .modal-header,
            .modal-body {
                padding: 24px;
            }
            
            .section {
                padding: 60px 0;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 16px;
            }
            
            .hero-title {
                font-size: 32px;
            }
            
            .btn-lg {
                padding: 14px 24px;
            }
            
            .search-card {
                padding: 24px;
            }
            
            .modal-header,
            .modal-body {
                padding: 20px;
            }
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .visible {
            display: block !important;
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .mt-1 { margin-top: 4px; }
        .mt-2 { margin-top: 8px; }
        .mt-3 { margin-top: 12px; }
        .mt-4 { margin-top: 16px; }
        .mt-6 { margin-top: 24px; }
        .mt-8 { margin-top: 32px; }
        .mt-12 { margin-top: 48px; }

        .mb-1 { margin-bottom: 4px; }
        .mb-2 { margin-bottom: 8px; }
        .mb-3 { margin-bottom: 12px; }
        .mb-4 { margin-bottom: 16px; }
        .mb-6 { margin-bottom: 24px; }
        .mb-8 { margin-bottom: 32px; }
        .mb-12 { margin-bottom: 48px; }

        .p-0 { padding: 0; }
        .p-4 { padding: 16px; }
        .p-6 { padding: 24px; }
        .p-8 { padding: 32px; }

        .w-full { width: 100%; }
        .h-full { height: 100%; }

        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .gap-2 { gap: 8px; }
        .gap-4 { gap: 16px; }
        .gap-6 { gap: 24px; }

        .rounded { border-radius: var(--border-radius); }
        .rounded-lg { border-radius: var(--border-radius-lg); }
        .rounded-full { border-radius: 9999px; }

        .bg-white { background: var(--card-bg); }
        .bg-light { background: var(--light); }
        .bg-dark { background: var(--dark); }

        .text-white { color: white; }
        .text-primary { color: var(--primary); }
        .text-secondary { color: var(--secondary); }
        .text-success { color: var(--success); }
        .text-danger { color: var(--danger); }
        .text-warning { color: var(--warning); }
        .text-gray-500 { color: var(--dark-3); }
        .text-gray-600 { color: var(--dark-2); }

        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .font-bold { font-weight: 700; }
        .font-extrabold { font-weight: 800; }

        .shadow-sm { box-shadow: var(--shadow-sm); }
        .shadow { box-shadow: var(--shadow); }
        .shadow-md { box-shadow: var(--shadow-md); }
        .shadow-lg { box-shadow: var(--shadow-lg); }

        .cursor-pointer { cursor: pointer; }
        .cursor-not-allowed { cursor: not-allowed; }

        .opacity-0 { opacity: 0; }
        .opacity-50 { opacity: 0.5; }
        .opacity-100 { opacity: 1; }

        .transition-all { transition: var(--transition); }

        .overflow-hidden { overflow: hidden; }
        .overflow-y-auto { overflow-y: auto; }

        .relative { position: relative; }
        .absolute { position: absolute; }
        .fixed { position: fixed; }
        .sticky { position: sticky; }

        .z-10 { z-index: 10; }
        .z-20 { z-index: 20; }
        .z-30 { z-index: 30; }
        .z-40 { z-index: 40; }
        .z-50 { z-index: 50; }
        


        /* Profile Image Styles */
        #profileImageContainer {
            position: relative;
            background: var(--light-2);
        }

        #profileImageDisplay {
            display: none;
        }

        #profileImageDisplay.show {
            display: block;
        }

        #profileInitialsDisplay {
            display: flex;
        }

        #profileInitialsDisplay.hidden {
            display: none;
        }

        #changeProfileImageBtn {
            transition: var(--transition);
            box-shadow: var(--shadow);
        }

        #changeProfileImageBtn:hover {
            transform: scale(1.1);
        }

        /* Profile Upload Message */
        #profileUploadMessage.success {
            color: var(--success);
        }

        #profileUploadMessage.error {
            color: var(--danger);
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        /* Mobile menu styles */
        @media (max-width: 1024px) {
            .nav-links {
                position: fixed;
                top: var(--header-height);
                left: 0;
                right: 0;
                background: rgba(255, 255, 255, 0.98);
                backdrop-filter: blur(10px);
                flex-direction: column;
                padding: 20px;
                border-bottom: 1px solid var(--light-3);
                box-shadow: var(--shadow-lg);
                display: none;
                z-index: 999;
            }
            
            .nav-links.show {
                display: flex;
            }
            
            .nav-link {
                padding: 12px 16px;
                border-radius: var(--border-radius);
                margin: 4px 0;
            }
        }


        /* Archived property styling */
        .property-card.archived {
            opacity: 0.9;
            border-color: #E5E7EB;
        }

        .property-card.archived .property-image {
            filter: grayscale(30%);
        }

        .property-card.archived .property-title {
            color: #6B7280;
        }

        .property-card.archived .property-price {
            color: #6B7280;
        }

        /* Expiring properties warning */
        .expiring-badge {
            background: linear-gradient(135deg, #F59E0B 0%, #FBBF24 100%);
            color: white;
        }

        /* Notification badge */
        .notification-dot {
            width: 8px;
            height: 8px;
            background: #EF4444;
            border-radius: 50%;
            position: absolute;
            top: 8px;
            right: 8px;
        }

        .logo {
        display: inline-flex;
        align-items: center;
        text-decoration: none;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .logo-svg {
        height: 44px;
        width: auto;
        filter: drop-shadow(0 2px 4px rgba(124, 58, 237, 0.1));
        transition: all 0.4s ease;
        }

        /* Hover Effects */
        .logo:hover .logo-svg {
        transform: translateY(-2px);
        filter: drop-shadow(0 6px 12px rgba(124, 58, 237, 0.15));
        }

        .logo:hover .house-icon {
        animation: houseFloat 1.5s ease infinite;
        }

        .logo:hover .verified-badge {
        animation: badgePulse 2s ease infinite;
        }

        /* Connection Wave Animation */
        .logo:hover path[stroke="url(#waveGradient)"] {
        animation: waveMove 1.5s ease infinite;
        stroke-dasharray: 20;
        stroke-dashoffset: 40;
        }

        /* Keyframe Animations */
        @keyframes houseFloat {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-3px); }
        }

        @keyframes badgePulse {
        0%, 100% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.05); opacity: 0.9; }
        }

        @keyframes waveMove {
        0% { stroke-dashoffset: 40; }
        100% { stroke-dashoffset: 0; }
        }

        /* Dark Theme Support */
        [data-theme="dark"] .logo-svg {
        filter: drop-shadow(0 2px 8px rgba(124, 58, 237, 0.2));
        }

        [data-theme="dark"] text[fill="#1F2937"] {
        fill: #F9FAFB;
        }

        [data-theme="dark"] text[fill="#6B7280"] {
        fill: #9CA3AF;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
        .logo-svg {
            height: 36px;
            width: auto;
        }
        
        /* Hide tagline on mobile */
        text[x="70"][y="40"] {
            display: none;
        }
        }

    </style>
</head>
<body>
    <!-- Header -->
    <header class="header" id="header">
        <div class="container">
            <nav class="nav">
                <a href="#" class="logo" id="homeBtn">
  <svg width="260" height="44" viewBox="0 0 260 44" fill="none" xmlns="http://www.w3.org/2000/svg" class="logo-svg">
    <!-- Modern House with Depth -->
    <g class="house-icon">
      <!-- House base with shadow -->
      <path d="M15 18C15 16.3431 16.3431 15 18 15H27C28.6569 15 30 16.3431 30 18V28H15V18Z" fill="#7C3AED" fill-opacity="0.9"/>
      <!-- Roof with gradient -->
      <path d="M22.5 10L13 18H32L22.5 10Z" fill="url(#roofGradient)"/>
      <!-- Windows -->
      <rect x="17" y="20" width="4" height="4" rx="1" fill="#C4B5FD"/>
      <rect x="24" y="20" width="4" height="4" rx="1" fill="#C4B5FD"/>
      <!-- Door -->
      <rect x="20" y="24" width="5" height="4" rx="1" fill="#8B5CF6"/>
      <circle cx="22" cy="26" r="0.5" fill="white"/>
      <!-- Roof accent -->
      <path d="M22.5 10L18 14" stroke="#A78BFA" stroke-width="0.8" stroke-linecap="round"/>
      <path d="M22.5 10L27 14" stroke="#A78BFA" stroke-width="0.8" stroke-linecap="round"/>
    </g>
    
    <!-- Connection Wave -->
    <path d="M38 22C40 20 42 24 44 22C46 20 48 24 50 22" stroke="url(#waveGradient)" stroke-width="2" stroke-linecap="round"/>
    
    <!-- Verified Badge -->
    <g class="verified-badge">
      <circle cx="58" cy="22" r="6" fill="url(#badgeGradient)"/>
      <path d="M56 22L57.5 23.5L60 20" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
      <circle cx="58" cy="22" r="5.5" stroke="white" stroke-opacity="0.3"/>
    </g>
    
    <!-- Logo Text with Modern Typography -->
    <g class="logo-text">
      <!-- Direct - Gradient Fill with Shadow -->
      <text x="72" y="28" font-family="'Inter', sans-serif" font-weight="800" font-size="22" fill="#1F2937" opacity="0.1">Direct</text>
      <text x="70" y="26" font-family="'Inter', sans-serif" font-weight="800" font-size="22" fill="url(#directGradient)">Direct</text>
      
      <!-- Landlord - Green with Glow -->
      <text x="145" y="28" font-family="'Inter', sans-serif" font-weight="800" font-size="22" fill="#10B981" opacity="0.1">Landlord</text>
      <text x="143" y="26" font-family="'Inter', sans-serif" font-weight="800" font-size="22" fill="url(#landlordGradient)">Landlord</text>
      
      <!-- Tagline - WIDER and PROPERLY SPACED -->
      <text x="70" y="40" font-family="'Inter', sans-serif" font-weight="500" font-size="10" fill="#6B7280" letter-spacing="0.8">NO AGENTS â€¢ NO COMMISSIONS</text>
    </g>
    
    <!-- Decorative Elements - Adjusted positions -->
    <circle cx="10" cy="32" r="1" fill="#7C3AED" fill-opacity="0.3"/>
    <circle cx="245" cy="12" r="1.5" fill="#10B981" fill-opacity="0.3"/>
    <circle cx="250" cy="35" r="1" fill="#8B5CF6" fill-opacity="0.3"/>
    
    <!-- Background Glow -->
    <circle cx="22" cy="22" r="18" fill="#7C3AED" fill-opacity="0.05"/>
    <circle cx="58" cy="22" r="12" fill="#10B981" fill-opacity="0.05"/>
    
    <defs>
      <!-- Gradients -->
      <linearGradient id="roofGradient" x1="22.5" y1="10" x2="22.5" y2="18">
        <stop stop-color="#8B5CF6"/>
        <stop offset="1" stop-color="#7C3AED"/>
      </linearGradient>
      
      <linearGradient id="directGradient" x1="70" y1="10" x2="125" y2="30">
        <stop stop-color="#7C3AED"/>
        <stop offset="0.5" stop-color="#A78BFA"/>
        <stop offset="1" stop-color="#7C3AED"/>
      </linearGradient>
      
      <linearGradient id="landlordGradient" x1="143" y1="10" x2="215" y2="30">
        <stop stop-color="#10B981"/>
        <stop offset="0.5" stop-color="#34D399"/>
        <stop offset="1" stop-color="#10B981"/>
      </linearGradient>
      
      <linearGradient id="badgeGradient" x1="52" y1="16" x2="64" y2="28">
        <stop stop-color="#10B981"/>
        <stop offset="1" stop-color="#34D399"/>
      </linearGradient>
      
      <linearGradient id="waveGradient" x1="38" y1="20" x2="50" y2="24">
        <stop stop-color="#7C3AED" offset="0%"/>
        <stop stop-color="#A78BFA" offset="50%"/>
        <stop stop-color="#10B981" offset="100%"/>
      </linearGradient>
      
      <!-- Glow Effect -->
      <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
        <feGaussianBlur stdDeviation="2" result="blur"/>
        <feComposite in="SourceGraphic" in2="blur" operator="over"/>
      </filter>
    </defs>
  </svg>
</a>
                
                <div class="nav-links">
                    <a href="#" class="nav-link active" id="browseBtn">
                        <i class="fas fa-search"></i> Browse
                    </a>
                    <a href="#" class="nav-link" id="listBtn">
                        <i class="fas fa-plus-circle"></i> List Property
                    </a>
                    <a href="#" class="nav-link" id="howItWorksBtn">
                        <i class="fas fa-question-circle"></i> How It Works
                    </a>
                    <div class="user-menu" id="userMenu"></div>
                </div>
                
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main id="mainContent">
        <!-- Hero Section -->
        <section class="hero" id="heroSection">
            <div class="container">
                <div class="hero-content">
                    <h1 class="hero-title">Find Your Perfect Rental, Direct from Landlord</h1>
                    <p class="hero-subtitle">
                        Connect directly with verified landlords. No agents, no commissions. 
                        Browse thousands of properties and find your perfect home today.
                    </p>
                    <div class="hero-actions flex gap-4">
                        <button class="btn btn-primary btn-lg" id="startBrowsingBtn">
                            <i class="fas fa-search"></i> Browse Properties
                        </button>
                        <button class="btn btn-outline btn-lg" id="heroListBtn">
                            <i class="fas fa-home"></i> List Your Property
                        </button>
                    </div>
                    <div class="hero-stats">
                        <div class="stat">
                            <div class="stat-number" id="totalProperties">0</div>
                            <div class="stat-label">Properties Listed</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="verifiedLandlords">0</div>
                            <div class="stat-label">Verified Landlords</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="activeUsers">0</div>
                            <div class="stat-label">Active Users</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Search Section -->
        <section class="search-section">
            <div class="container">
                <div class="search-card">
                    <h2 class="search-title">Find Your Perfect Property</h2>
                    <div class="search-grid">
                        <div class="form-group">
                            <label class="form-label">Location</label>
                            <select class="form-control form-select" id="searchLocation">
                                <option value="">All Locations</option>
                                <option value="Lagos">Lagos</option>
                                <option value="Abuja">Abuja</option>
                                <option value="Port Harcourt">Port Harcourt</option>
                                <option value="Ibadan">Ibadan</option>
                                <option value="Kano">Kano</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Property Type</label>
                            <select class="form-control form-select" id="searchType">
                                <option value="">All Types</option>
                                <option value="Apartment">Apartment</option>
                                <option value="House">House</option>
                                <option value="Studio">Studio</option>
                                <option value="Duplex">Duplex</option>
                                <option value="Commercial">Commercial</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Price Range</label>
                            <select class="form-control form-select" id="searchPrice">
                                <option value="">Any Price</option>
                                <option value="50000">â‚¦50,000 & below</option>
                                <option value="100000">â‚¦100,000 & below</option>
                                <option value="200000">â‚¦200,000 & below</option>
                                <option value="500000">â‚¦500,000 & below</option>
                                <option value="1000000">â‚¦1,000,000 & below</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">&nbsp;</label>
                            <button class="btn btn-primary w-full" id="searchBtn">
                                <i class="fas fa-search"></i> Search Properties
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Properties Section -->
        <section class="section" id="propertiesSection">
            <div class="container">
                <h2 class="section-title">Featured Properties</h2>
                <p class="section-subtitle">Browse our selection of premium properties from verified landlords</p>
                
                <div class="properties-grid" id="propertiesGrid">
                    <div class="empty-state">
                        <div class="loader mx-auto mb-4"></div>
                        <h3>Loading Properties...</h3>
                        <p>Please wait while we load the latest properties for you.</p>
                    </div>
                </div>
                
                <div class="load-more">
                    <button class="btn btn-outline" id="loadMoreBtn">
                        <span class="btn-text">Load More Properties</span>
                        <div class="loader hidden" id="loadMoreLoader"></div>
                    </button>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section class="section bg-light" id="howItWorksSection" style="display: none;">
            <div class="container">
                <h2 class="section-title">How DirectLandlord Works</h2>
                <p class="section-subtitle">Simple, secure, and direct - that's our promise</p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-12">
                    <div class="bg-white p-8 rounded-lg shadow text-center">
                        <div class="w-20 h-20 bg-primary rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-search text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-4">1. Browse Properties</h3>
                        <p class="text-gray-600">Search through thousands of verified properties with detailed descriptions, photos, and location information.</p>
                    </div>
                    
                    <div class="bg-white p-8 rounded-lg shadow text-center">
                        <div class="w-20 h-20 bg-success rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fab fa-whatsapp text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-4">2. Contact Directly</h3>
                        <p class="text-gray-600">Connect with landlords directly via WhatsApp. No middlemen, no commissions, just direct communication.</p>
                    </div>
                    
                    <div class="bg-white p-8 rounded-lg shadow text-center">
                        <div class="w-20 h-20 bg-primary rounded-full flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-home text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-bold mb-4">3. Secure Your Home</h3>
                        <p class="text-gray-600">Finalize arrangements directly with the landlord. All listings are verified for your safety and security.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- List Property Section -->
        <section class="section" id="listPropertySection" style="display: none;">
            <div class="container">
                <div class="bg-white rounded-lg shadow-lg p-8">
                    <h2 class="section-title text-left mb-6">List Your Property</h2>
                    
                    <div class="alert bg-red-50 border border-red-200 rounded-lg p-4 mb-6 hidden" id="listPropertyAlert">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-exclamation-triangle text-red-600"></i>
                            <span id="alertMessage" class="text-red-700"></span>
                        </div>
                    </div>
                    
                    <form id="propertyForm" class="hidden">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Property Type *</label>
                                <select class="form-control form-select" id="propertyType" required>
                                    <option value="">Select Type</option>
                                    <option value="Apartment">Apartment</option>
                                    <option value="House">House</option>
                                    <option value="Studio">Studio</option>
                                    <option value="Duplex">Duplex</option>
                                    <option value="Commercial">Commercial Space</option>
                                </select>
                                <div class="error-message" id="propertyTypeError"></div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Location (Area) *</label>
                                <input type="text" class="form-control" id="propertyLocation" 
                                       placeholder="e.g., Victoria Island, Lagos" required>
                                <div class="error-message" id="propertyLocationError"></div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Rent Amount (â‚¦) *</label>
                                <input type="number" class="form-control" id="propertyRent" 
                                       placeholder="e.g., 250000" min="1" required>
                                <div class="error-message" id="propertyRentError"></div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Payment Frequency *</label>
                                <select class="form-control form-select" id="propertyFrequency" required>
                                    <option value="">Select Frequency</option>
                                    <option value="Monthly">Monthly</option>
                                    <option value="Quarterly">Quarterly</option>
                                    <option value="Yearly">Yearly</option>
                                </select>
                                <div class="error-message" id="propertyFrequencyError"></div>
                            </div>
                            
                            <div class="form-group full-width">
                                <label class="form-label">Description *</label>
                                <textarea class="form-control" id="propertyDescription" rows="4" 
                                          placeholder="Describe your property including rooms, amenities, nearby facilities, etc." required></textarea>
                                <div class="error-message" id="propertyDescriptionError"></div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">WhatsApp Contact *</label>
                                <input type="tel" class="form-control" id="whatsappContact" 
                                       placeholder="+2348012345678" required>
                                <div class="error-message" id="whatsappContactError"></div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Bedrooms</label>
                                <select class="form-control form-select" id="propertyBedrooms">
                                    <option value="">Select</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5+">5+</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Bathrooms</label>
                                <select class="form-control form-select" id="propertyBathrooms">
                                    <option value="">Select</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5+">5+</option>
                                </select>
                            </div>
                            
                            <div class="form-group full-width">
                                <label class="form-label">Upload Images (Max 5 images, 5MB each) *</label>
                                <div class="image-upload" id="imageUpload">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <h3 class="font-semibold mb-2">Click to Upload Images</h3>
                                    <p class="text-gray-600">Drag & drop or click to select images</p>
                                    <input type="file" class="hidden" id="propertyImages" accept="image/*" multiple>
                                </div>
                                <div class="error-message" id="propertyImagesError"></div>
                                <div class="upload-progress" id="uploadProgress">
                                    <div class="upload-progress-bar" id="uploadProgressBar"></div>
                                </div>
                                <div class="image-preview" id="imagePreview"></div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between mt-8">
                            <button type="button" class="btn btn-outline" id="cancelPropertyBtn">
                                Cancel
                            </button>
                            <button type="submit" class="btn btn-primary" id="submitPropertyBtn">
                                <span class="btn-text">List Property Now</span>
                                <div class="loader hidden" id="propertyLoader"></div>
                            </button>
                        </div>
                    </form>
                    
                    <div class="text-center py-12" id="listPropertyLoginPrompt">
                        <i class="fas fa-lock text-4xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Login Required</h3>
                        <p class="text-gray-600 mb-6">Please login or create an account as a landlord to list properties.</p>
                        <div class="flex gap-4 justify-center">
                            <button class="btn btn-primary" id="loginToContinueBtn">Login</button>
                            <button class="btn btn-outline" id="signupToContinueBtn">Create Account</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modals -->
    
    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Welcome Back</h3>
                <button class="modal-close close-modal" data-modal="loginModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="auth-tabs">
                    <button class="auth-tab active" data-tab="login">Login</button>
                    <button class="auth-tab" data-tab="signup">Sign Up</button>
                </div>
                
                <form id="loginForm" class="auth-form">
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label class="form-label">Email Address</label>
                            <input type="email" class="form-control" id="loginEmail" required>
                            <div class="error-message" id="loginEmailError"></div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label class="form-label">Password</label>
                            <input type="password" class="form-control" id="loginPassword" required>
                            <div class="error-message" id="loginPasswordError"></div>
                        </div>
                        
                        <div class="form-group full-width">
                            <button type="submit" class="btn btn-primary w-full" id="loginSubmitBtn">
                                <span class="btn-text">Login to Account</span>
                                <div class="loader hidden" id="loginLoader"></div>
                            </button>
                        </div>
                        
                        <div class="form-group full-width text-center">
                            <a href="#" class="text-primary font-semibold" id="forgotPasswordLink">
                                Forgot your password?
                            </a>
                        </div>
                    </div>
                </form>
                
                <form id="signupForm" class="auth-form hidden">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">First Name *</label>
                            <input type="text" class="form-control" id="signupFirstName" required>
                            <div class="error-message" id="signupFirstNameError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Last Name *</label>
                            <input type="text" class="form-control" id="signupLastName" required>
                            <div class="error-message" id="signupLastNameError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Email Address *</label>
                            <input type="email" class="form-control" id="signupEmail" required>
                            <div class="error-message" id="signupEmailError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Phone Number *</label>
                            <input type="tel" class="form-control" id="signupPhone" required>
                            <div class="error-message" id="signupPhoneError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">I am a *</label>
                            <select class="form-control form-select" id="signupRole" required>
                                <option value="">Select Role</option>
                                <option value="landlord">Landlord</option>
                                <option value="renter">Rent Seeker</option>
                            </select>
                            <div class="error-message" id="signupRoleError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Password *</label>
                            <input type="password" class="form-control" id="signupPassword" required>
                            <div class="error-message" id="signupPasswordError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Confirm Password *</label>
                            <input type="password" class="form-control" id="signupConfirmPassword" required>
                            <div class="error-message" id="signupConfirmPasswordError"></div>
                        </div>
                        
                        <div class="form-group full-width">
                            <div class="flex items-center gap-2">
                                <input type="checkbox" id="signupTerms" required>
                                <label for="signupTerms" class="text-sm text-gray-600">
                                    I agree to the <a href="terms.html" class="text-primary font-medium">Terms of Service</a> and <a href="privacy.html" class="text-primary font-medium">Privacy Policy</a>
                                </label>
                            </div>
                            <div class="error-message" id="signupTermsError"></div>
                        </div>
                        
                        <div class="form-group full-width">
                            <button type="submit" class="btn btn-primary w-full" id="signupSubmitBtn">
                                <span class="btn-text">Create Account</span>
                                <div class="loader hidden" id="signupLoader"></div>
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div class="modal" id="forgotPasswordModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">Reset Password</h3>
                <button class="modal-close close-modal" data-modal="forgotPasswordModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p class="mb-6 text-gray-600">Enter your email address and we'll send you a link to reset your password.</p>
                
                <form id="forgotPasswordForm">
                    <div class="form-group mb-6">
                        <label class="form-label">Email Address *</label>
                        <input type="email" class="form-control" id="forgotPasswordEmail" required>
                        <div class="error-message" id="forgotPasswordEmailError"></div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-full" id="forgotPasswordSubmitBtn">
                        <span class="btn-text">Send Reset Link</span>
                        <div class="loader hidden" id="forgotPasswordLoader"></div>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Property Details Modal -->
    <div class="modal" id="propertyDetailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="propertyModalTitle"></h3>
                <button class="modal-close close-modal" data-modal="propertyDetailsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="propertyModalContent"></div>
            </div>
        </div>
    </div>

    <!-- Report Property Modal -->
    <div class="modal" id="reportModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">Report Property</h3>
                <button class="modal-close close-modal" data-modal="reportModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p class="mb-6 text-gray-600">Please tell us why you're reporting this property. Your report helps keep our community safe.</p>
                
                <form id="reportForm">
                    <input type="hidden" id="reportPropertyId">
                    
                    <div class="form-group mb-6">
                        <label class="form-label">Reason for Report *</label>
                        <select class="form-control form-select" id="reportReason" required>
                            <option value="">Select Reason</option>
                            <option value="fake">Fake Listing</option>
                            <option value="scam">Possible Scam</option>
                            <option value="wrong_info">Wrong Information</option>
                            <option value="suspicious">Suspicious Activity</option>
                            <option value="other">Other</option>
                        </select>
                        <div class="error-message" id="reportReasonError"></div>
                    </div>
                    
                    <div class="form-group mb-6">
                        <label class="form-label">Additional Details (Optional)</label>
                        <textarea class="form-control" id="reportDetails" rows="3" 
                                  placeholder="Please provide more details about your report..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-danger w-full" id="reportSubmitBtn">
                        <span class="btn-text">Submit Report</span>
                        <div class="loader hidden" id="reportLoader"></div>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div>
                    <h3 class="footer-title">DirectLandlord</h3>
                    <p class="text-gray-400 mb-4">
                        Connecting landlords and rent seekers directly. No agents, no commissions.
                    </p>
                    <div class="flex gap-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#">Browse Properties</a></li>
                        <li><a href="#">List Property</a></li>
                        <li><a href="#">How It Works</a></li>
                        <li><a href="#">Safety Tips</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="footer-title">Support</h3>
                    <ul class="footer-links">
                        <li><a href="#">Help Center</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                        <li><a href="#">Report Issue</a></li>
                        <li><a href="#">FAQ</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="footer-title">Legal</h3>
                    <ul class="footer-links">
                        <li><a href="terms.html">Terms of Service</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="gdpr.html">GDPR</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 DirectLandlord. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

    <!-- Main Application -->
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAfYV8DS0jz2UupYpL6XSIlY5CBbxmjeFw",
            authDomain: "directlandlord-18dec.firebaseapp.com",
            projectId: "directlandlord-18dec",
            storageBucket: "directlandlord-18dec.firebasestorage.app",
            messagingSenderId: "1021329059592",
            appId: "1:1021329059592:web:306b898dfc35b06d0006bd",
            measurementId: "G-57D1E52Y7H"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();
        
        // Global State
        const state = {
            currentUser: null,
            userData: null,
            properties: [],
            lastVisible: null,
            isLoading: false,
            currentPage: 1,
            filters: {
                location: '',
                type: '',
                maxPrice: ''
            },
            savedProperties: new Set(),
            imageUploads: [],
            uploadProgress: 0
        };

        // ==================== CORS FIX FOR LOCALHOST ====================
        // This fixes Firebase Storage CORS issues for localhost
        const setupCORSWorkaround = () => {
            // Override Firebase Storage to add CORS headers
            const originalPut = storage.ref().put;
            
            storage.ref().put = function(file, metadata) {
                // Add CORS headers to metadata
                const enhancedMetadata = {
                    ...metadata,
                    customMetadata: {
                        ...(metadata?.customMetadata || {}),
                        'Access-Control-Allow-Origin': '*'
                    }
                };
                
                return originalPut.call(this, file, enhancedMetadata);
            };
        };

        // ==================== VALIDATION HELPER ====================
        class ValidationHelper {
            static validateEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!email || email.trim() === '') return 'Email is required';
                if (!re.test(email)) return 'Please enter a valid email address';
                return null;
            }

            static validatePassword(password) {
                if (!password || password.trim() === '') return 'Password is required';
                if (password.length < 8) return 'Password must be at least 8 characters';
                if (!/(?=.*[A-Z])/.test(password)) return 'Password must contain at least one uppercase letter';
                if (!/(?=.*[a-z])/.test(password)) return 'Password must contain at least one lowercase letter';
                if (!/(?=.*\d)/.test(password)) return 'Password must contain at least one number';
                return null;
            }

            static validatePhone(phone) {
                const clean = phone.replace(/\D/g, '');
                if (!phone || phone.trim() === '') return 'Phone number is required';
                if (clean.length < 10) return 'Phone number must be at least 10 digits';
                if (!/^\+?[1-9]\d{1,14}$/.test(phone)) return 'Please enter a valid phone number (e.g., +2348012345678)';
                return null;
            }

            static validateName(name, field = 'Name') {
                if (!name || name.trim() === '') return `${field} is required`;
                if (name.length < 2) return `${field} must be at least 2 characters`;
                if (!/^[a-zA-Z\s'-]+$/.test(name)) return `${field} can only contain letters, spaces, hyphens, and apostrophes`;
                return null;
            }

            static validateTerms(checked) {
                if (!checked) return 'You must agree to the Terms of Service';
                return null;
            }

            static validateNumber(value, field = 'Value', min = 1) {
                if (!value || value.trim() === '') return `${field} is required`;
                const num = Number(value);
                if (isNaN(num)) return `${field} must be a valid number`;
                if (num < min) return `${field} must be at least ${min}`;
                return null;
            }

            static validateSelect(value, field = 'Selection') {
                if (!value || value.trim() === '') return `${field} is required`;
                return null;
            }

            static validateText(text, field = 'Text', minLength = 10) {
                if (!text || text.trim() === '') return `${field} is required`;
                if (text.trim().length < minLength) return `${field} must be at least ${minLength} characters`;
                return null;
            }

            static validateWhatsApp(phone) {
                const clean = phone.replace(/\D/g, '');
                if (!phone || phone.trim() === '') return 'WhatsApp number is required';
                if (clean.length < 10) return 'WhatsApp number must be at least 10 digits';
                if (!/^\+?[1-9]\d{1,14}$/.test(phone)) return 'Please enter a valid WhatsApp number';
                return null;
            }

            static validateImages(files, maxCount = 5, maxSizeMB = 5) {
                if (!files || files.length === 0) return 'At least one image is required';
                if (files.length > maxCount) return `Maximum ${maxCount} images allowed`;
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    if (!file.type.startsWith('image/')) {
                        return 'Only image files are allowed';
                    }
                    if (file.size > maxSizeMB * 1024 * 1024) {
                        return `Image size must be less than ${maxSizeMB}MB`;
                    }
                }
                return null;
            }
        }

        // ==================== UTILITY FUNCTIONS ====================
        class Utils {
            static formatPrice(amount) {
                if (!amount) return 'â‚¦0';
                return new Intl.NumberFormat('en-NG', {
                    style: 'currency',
                    currency: 'NGN',
                    minimumFractionDigits: 0
                }).format(amount);
            }

            static formatDate(timestamp) {
                if (!timestamp) return '';
                const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
                return date.toLocaleDateString('en-NG', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
            }

            static showToast(message, type = 'info', title = '') {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                
                const icons = {
                    success: 'fa-check-circle',
                    error: 'fa-exclamation-circle',
                    warning: 'fa-exclamation-triangle',
                    info: 'fa-info-circle'
                };
                
                toast.innerHTML = `
                    <i class="fas ${icons[type]} toast-icon"></i>
                    <div class="toast-content">
                        ${title ? `<div class="toast-title">${title}</div>` : ''}
                        <div class="toast-message">${message}</div>
                    </div>
                    <button class="toast-close">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                const container = document.getElementById('toastContainer');
                container.appendChild(toast);
                
                // Auto-remove after 5 seconds
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateX(100%)';
                    setTimeout(() => container.removeChild(toast), 300);
                }, 5000);
                
                // Close button
                toast.querySelector('.toast-close').addEventListener('click', () => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateX(100%)';
                    setTimeout(() => container.removeChild(toast), 300);
                });
            }

            static showLoader(button) {
                const loader = button.querySelector('.loader');
                const text = button.querySelector('.btn-text');
                if (loader && text) {
                    loader.classList.remove('hidden');
                    text.classList.add('hidden');
                }
                button.disabled = true;
            }

            static hideLoader(button) {
                const loader = button.querySelector('.loader');
                const text = button.querySelector('.btn-text');
                if (loader && text) {
                    loader.classList.add('hidden');
                    text.classList.remove('hidden');
                }
                button.disabled = false;
            }

            static showError(fieldId, message) {
                const errorElement = document.getElementById(fieldId);
                const inputElement = document.getElementById(fieldId.replace('Error', ''));
                
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.classList.add('show');
                }
                
                if (inputElement) {
                    inputElement.classList.add('error');
                }
            }

            static hideError(fieldId) {
                const errorElement = document.getElementById(fieldId);
                const inputElement = document.getElementById(fieldId.replace('Error', ''));
                
                if (errorElement) {
                    errorElement.classList.remove('show');
                }
                
                if (inputElement) {
                    inputElement.classList.remove('error');
                }
            }

            static clearAllErrors(formId) {
                const form = document.getElementById(formId);
                if (form) {
                    form.querySelectorAll('.error-message').forEach(el => {
                        el.classList.remove('show');
                    });
                    form.querySelectorAll('.form-control').forEach(el => {
                        el.classList.remove('error');
                    });
                }
            }

            static getAvatarInitials(name) {
                if (!name) return 'U';
                return name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
            }

            static sanitizeInput(text) {
                if (!text) return '';
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            static updateUploadProgress(progress) {
                const progressBar = document.getElementById('uploadProgressBar');
                const progressContainer = document.getElementById('uploadProgress');
                
                if (progressBar && progressContainer) {
                    progressBar.style.width = `${progress}%`;
                    if (progress > 0 && progress < 100) {
                        progressContainer.classList.add('show');
                    } else {
                        setTimeout(() => {
                            progressContainer.classList.remove('show');
                            progressBar.style.width = '0%';
                        }, 500);
                    }
                }
            }

            static async delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // ==================== IMAGE UPLOAD MANAGER ====================
        class ImageUploadManager {
            
            static async uploadImages(files, userId) {
                try {
                    const uploadedUrls = [];
                    
                    for (let i = 0; i < Math.min(files.length, 5); i++) {
                        const file = files[i];
                        
                        // Create unique filename
                        const timestamp = Date.now();
                        const fileName = `${timestamp}_${file.name.replace(/\s+/g, '_')}`;
                        
                        // Create storage reference
                        const storageRef = storage.ref()
                            .child('properties')
                            .child(userId)
                            .child(fileName);
                        
                        // Create upload task with metadata
                        const metadata = {
                            contentType: file.type,
                            customMetadata: {
                                uploadedBy: userId,
                                timestamp: timestamp.toString()
                            }
                        };
                        
                        // Upload file to Firebase Storage
                        const uploadTask = storageRef.put(file, metadata);
                        
                        // Wait for upload to complete
                        await new Promise((resolve, reject) => {
                            uploadTask.on(
                                'state_changed',
                                (snapshot) => {
                                    // Update progress
                                    const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                                    Utils.updateUploadProgress(progress);
                                },
                                (error) => {
                                    reject(new Error(`Upload failed: ${error.message}`));
                                },
                                async () => {
                                    try {
                                        // Get download URL
                                        const downloadURL = await storageRef.getDownloadURL();
                                        uploadedUrls.push(downloadURL);
                                        resolve();
                                    } catch (urlError) {
                                        reject(new Error(`Failed to get download URL: ${urlError.message}`));
                                    }
                                }
                            );
                        });
                    }
                    
                    return uploadedUrls;
                } catch (error) {
                    console.error('Image upload error:', error);
                    throw error;
                }
            }

            static async deleteImage(imageUrl) {
                try {
                    // Extract path from URL
                    const url = new URL(imageUrl);
                    const path = decodeURIComponent(url.pathname.split('/o/')[1].split('?')[0]);
                    
                    // Delete from storage
                    const storageRef = storage.ref(path);
                    await storageRef.delete();
                    return true;
                } catch (error) {
                    console.error('Delete image error:', error);
                    
                    // Alternative method for Firebase Storage URLs
                    try {
                        const matches = imageUrl.match(/profile_images%2F(.*?)\?/);
                        if (matches && matches[1]) {
                            const decodedPath = decodeURIComponent(matches[1]);
                            const storageRef = storage.ref().child('profile_images').child(decodedPath);
                            await storageRef.delete();
                            return true;
                        }
                    } catch (error2) {
                        console.error('Alternative delete failed:', error2);
                    }
                    
                    return false;
                }
            }

            static async deleteImage(imageUrl) {
                try {
                    // Extract path from URL
                    const matches = imageUrl.match(/properties%2F(.*?)\?/);
                    if (matches && matches[1]) {
                        const decodedPath = decodeURIComponent(matches[1]);
                        const storageRef = storage.ref().child(decodedPath);
                        await storageRef.delete();
                        return true;
                    }
                    return false;
                } catch (error) {
                    console.error('Delete image error:', error);
                    return false;
                }
            }

            static async compressImage(file, maxWidth = 800, quality = 0.7) {
                return new Promise((resolve) => {
                    if (!file.type.startsWith('image/')) {
                        resolve(file);
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = new Image();
                        img.onload = () => {
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            
                            // Calculate new dimensions
                            let width = img.width;
                            let height = img.height;
                            
                            if (width > maxWidth) {
                                height = (height * maxWidth) / width;
                                width = maxWidth;
                            }
                            
                            canvas.width = width;
                            canvas.height = height;
                            ctx.drawImage(img, 0, 0, width, height);
                            
                            // Convert to compressed blob
                            canvas.toBlob((blob) => {
                                resolve(new File([blob], file.name, { 
                                    type: 'image/jpeg',
                                    lastModified: Date.now()
                                }));
                            }, 'image/jpeg', quality);
                        };
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                });
            }
        }

        // ==================== AUTHENTICATION MANAGER ====================
        class AuthManager {
            static async signup(userData) {
                try {
                    // Comprehensive validation BEFORE Firebase calls
                    const errors = [];
                    
                    // Validate names
                    const firstNameError = ValidationHelper.validateName(userData.firstName, 'First name');
                    const lastNameError = ValidationHelper.validateName(userData.lastName, 'Last name');
                    if (firstNameError) errors.push(firstNameError);
                    if (lastNameError) errors.push(lastNameError);
                    
                    // Validate email
                    const emailError = ValidationHelper.validateEmail(userData.email);
                    if (emailError) errors.push(emailError);
                    
                    // Validate phone
                    const phoneError = ValidationHelper.validatePhone(userData.phone);
                    if (phoneError) errors.push(phoneError);
                    
                    // Validate role
                    const roleError = ValidationHelper.validateSelect(userData.role, 'Role');
                    if (roleError) errors.push(roleError);
                    
                    // Validate password
                    const passwordError = ValidationHelper.validatePassword(userData.password);
                    if (passwordError) errors.push(passwordError);
                    
                    // Validate confirm password
                    if (userData.password !== userData.confirmPassword) {
                        errors.push('Passwords do not match');
                    }
                    
                    // Validate terms
                    const termsError = ValidationHelper.validateTerms(userData.acceptedTerms);
                    if (termsError) errors.push(termsError);
                    
                    // Stop if validation errors
                    if (errors.length > 0) {
                        throw new Error(errors.join('\n'));
                    }

                    // Check if user already exists
                    try {
                        const methods = await auth.fetchSignInMethodsForEmail(userData.email);
                        if (methods.length > 0) {
                            throw new Error('Email already registered. Please login instead.');
                        }
                    } catch (error) {
                        console.log('Email check skipped:', error.message);
                    }

                    // Create Firebase user
                    const userCredential = await auth.createUserWithEmailAndPassword(
                        userData.email,
                        userData.password
                    );

                    // Update user profile
                    await userCredential.user.updateProfile({
                        displayName: `${userData.firstName} ${userData.lastName}`
                    });

                    // Create user document in Firestore
                    await db.collection('users').doc(userCredential.user.uid).set({
                        firstName: userData.firstName.trim(),
                        lastName: userData.lastName.trim(),
                        email: userData.email.trim(),
                        phone: userData.phone.trim(),
                        role: userData.role,
                        isAdmin: false, // Add this line - default false
                        avatar: null,
                        isVerified: false,
                        verificationLevel: 0,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
                        notificationPreferences: {
                            inquiries: true,
                            reports: true,
                            announcements: true
                        }
                    });

                    // Send verification email
                    await userCredential.user.sendEmailVerification();

                    return userCredential.user;
                } catch (error) {
                    console.error('Signup error:', error);
                    
                    let errorMessage = error.message;
                    if (error.code === 'auth/email-already-in-use') {
                        errorMessage = 'Email already registered. Please login instead.';
                    } else if (error.code === 'auth/weak-password') {
                        errorMessage = 'Password is too weak. Please use a stronger password.';
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = 'Invalid email address. Please check and try again.';
                    }
                    
                    throw new Error(errorMessage);
                }
            }

            static async login(email, password) {
                    try {
                        // Validate inputs
                        if (!email || !password) {
                            throw new Error('Please enter email and password');
                        }

                        // Check if user exists first
                        try {
                            const methods = await auth.fetchSignInMethodsForEmail(email);
                            if (methods.length === 0) {
                                throw new Error('No account found with this email');
                            }
                        } catch (e) {
                            // Continue anyway
                        }

                        // Attempt login
                        const userCredential = await auth.signInWithEmailAndPassword(email, password);
                        const user = userCredential.user;
                        
                        // Check email verification
                        await user.reload();
                        if (!user.emailVerified) {
                            await auth.signOut();
                            throw new Error('Please verify your email first. Check your inbox.');
                        }
                        
                        return user;
                        
                    } catch (error) {
                        console.error('Login error:', error.code, error.message);
                        
                        // User-friendly error messages
                        let errorMessage = 'Login failed. Please check your credentials.';
                        
                        if (error.code === 'auth/invalid-credential' || 
                            error.code === 'auth/wrong-password') {
                            errorMessage = 'Incorrect password. Try again or reset password.';
                        } else if (error.code === 'auth/user-not-found') {
                            errorMessage = 'No account found with this email. Please sign up.';
                        } else if (error.code === 'auth/too-many-requests') {
                            errorMessage = 'Too many failed attempts. Try again later.';
                        } else if (error.code === 'auth/user-disabled') {
                            errorMessage = 'Account disabled. Contact support.';
                        } else if (error.message.includes('verify')) {
                            errorMessage = error.message;
                        }
                        
                        throw new Error(errorMessage);
                    }
                }

            static async logout() {
                try {
                    await auth.signOut();
                    state.currentUser = null;
                    state.userData = null;
                    state.savedProperties.clear();
                    Utils.showToast('Logged out successfully', 'success');
                } catch (error) {
                    console.error('Logout error:', error);
                    Utils.showToast('Error logging out', 'error');
                }
            }

            static async resetPassword(email) {
                try {
                    // Validate email
                    const emailError = ValidationHelper.validateEmail(email);
                    if (emailError) throw new Error(emailError);

                    await auth.sendPasswordResetEmail(email);
                    return true;
                } catch (error) {
                    console.error('Reset password error:', error);
                    
                    let errorMessage = error.message;
                    if (error.code === 'auth/user-not-found') {
                        errorMessage = 'No account found with this email.';
                    }
                    
                    throw new Error(errorMessage);
                }
            }
        }

        // ==================== PROPERTY MANAGER ====================
        class PropertyManager {
            static async createProperty(propertyData) {
                try {
                    // Validate property data BEFORE any uploads
                    const errors = [];
                    
                    const typeError = ValidationHelper.validateSelect(propertyData.type, 'Property type');
                    const locationError = ValidationHelper.validateText(propertyData.location, 'Location', 3);
                    const rentError = ValidationHelper.validateNumber(propertyData.rent, 'Rent amount', 1000);
                    const frequencyError = ValidationHelper.validateSelect(propertyData.frequency, 'Payment frequency');
                    const descriptionError = ValidationHelper.validateText(propertyData.description, 'Description', 20);
                    const whatsappError = ValidationHelper.validateWhatsApp(propertyData.whatsapp);
                    const imagesError = ValidationHelper.validateImages(propertyData.imageFiles);
                    
                    if (typeError) errors.push(typeError);
                    if (locationError) errors.push(locationError);
                    if (rentError) errors.push(rentError);
                    if (frequencyError) errors.push(frequencyError);
                    if (descriptionError) errors.push(descriptionError);
                    if (whatsappError) errors.push(whatsappError);
                    if (imagesError) errors.push(imagesError);

                    if (errors.length > 0) {
                        throw new Error(errors.join('\n'));
                    }

                    // Upload images to Firebase Storage
                    let imageUrls = [];
                    if (propertyData.imageFiles && propertyData.imageFiles.length > 0) {
                        Utils.showToast('Uploading images...', 'info', 'Please wait');
                        imageUrls = await ImageUploadManager.uploadImages(
                            propertyData.imageFiles, 
                            state.currentUser.uid
                        );
                    }

                    // Create property document
                    const propertyRef = db.collection('properties').doc();
                    const property = {
                        id: propertyRef.id,
                        ownerId: state.currentUser.uid,
                        ownerName: state.userData.firstName + ' ' + state.userData.lastName,
                        type: propertyData.type,
                        location: propertyData.location.trim(),
                        rent: Number(propertyData.rent),
                        frequency: propertyData.frequency,
                        description: Utils.sanitizeInput(propertyData.description),
                        whatsapp: propertyData.whatsapp.replace(/\D/g, ''),
                        bedrooms: propertyData.bedrooms || '',
                        bathrooms: propertyData.bathrooms || '',
                        images: imageUrls,
                        isVerified: false,
                        verificationLevel: 0,
                        isFeatured: false,
                        status: 'active',
                        listedAt: firebase.firestore.FieldValue.serverTimestamp(),
                        expiresAt: new Date(Date.now() + (14 * 24 * 60 * 60 * 1000)), // 14 days from now
                        archivedAt: null,
                        renewalCount: 0,
                        lastRenewedAt: null,
                        status: 'active',
                        reports: 0,
                        views: 0,
                        inquiries: 0,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    };

                    await propertyRef.set(property);

                    // Create audit log
                    await db.collection('auditLogs').add({
                        userId: state.currentUser.uid,
                        action: 'property_create',
                        targetId: propertyRef.id,
                        details: {
                            type: property.type,
                            location: property.location,
                            rent: property.rent,
                            imageCount: imageUrls.length
                        },
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });

                    return propertyRef.id;
                } catch (error) {
                    console.error('Create property error:', error);
                    throw error;
                }
            }

             static async renewProperty(propertyId) {
                try {
                    const now = new Date();
                    const expiresAt = new Date(now.getTime() + (14 * 24 * 60 * 60 * 1000));
                    
                    await db.collection('properties').doc(propertyId).update({
                        status: 'active',
                        listedAt: firebase.firestore.FieldValue.serverTimestamp(),
                        expiresAt: firebase.firestore.Timestamp.fromDate(expiresAt),
                        archivedAt: null,
                        renewalCount: firebase.firestore.FieldValue.increment(1),
                        lastRenewedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Create renewal notification
                    await db.collection('notifications').add({
                        userId: state.currentUser.uid,
                        type: 'property_renewed',
                        title: 'Property Renewed',
                        message: 'Your property listing has been renewed for another 14 days.',
                        propertyId: propertyId,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        read: false
                    });
                    
                    return true;
                } catch (error) {
                    console.error('Renew property error:', error);
                    throw error;
                }
            }
            
            static async getExpiringProperties() {
                try {
                    const now = new Date();
                    const threeDaysLater = new Date(now.getTime() + (3 * 24 * 60 * 60 * 1000));
                    
                    const query = await db.collection('properties')
                        .where('ownerId', '==', state.currentUser.uid)
                        .where('status', '==', 'active')
                        .where('expiresAt', '<=', firebase.firestore.Timestamp.fromDate(threeDaysLater))
                        .where('expiresAt', '>=', firebase.firestore.Timestamp.fromDate(now))
                        .get();
                    
                    return query.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                } catch (error) {
                    console.error('Get expiring properties error:', error);
                    return [];
                }
            }
            
            static async getArchivedProperties() {
                try {
                    const query = await db.collection('properties')
                        .where('ownerId', '==', state.currentUser.uid)
                        .where('status', '==', 'archived')
                        .orderBy('archivedAt', 'desc')
                        .limit(50)
                        .get();
                    
                    return query.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                } catch (error) {
                    console.error('Get archived properties error:', error);
                    return [];
                }
            }


            static async contactLandlord(propertyId) {
                // This method already exists in your code - just making sure it's accessible
                const property = await this.getPropertyById(propertyId);
                const whatsappUrl = await this.contactLandlord(property);
                window.open(whatsappUrl, '_blank');
            }

            static async getProperties(filters = {}, startAfter = null, limit = 6) {
                try {
                    let query = db.collection('properties')
                        .where('status', '==', 'active');

                    // For initial load, use createdAt ordering
                    if (!startAfter) {
                        query = query.orderBy('createdAt', 'desc');
                    }
                    
                    query = query.limit(limit);

                    // Apply pagination
                    if (startAfter) {
                        query = query.startAfter(startAfter);
                    }

                    const snapshot = await query.get();
                    const properties = [];
                    
                    // Store the last document for pagination
                    if (snapshot.docs.length > 0) {
                        state.lastVisible = snapshot.docs[snapshot.docs.length - 1];
                    } else {
                        state.lastVisible = null;
                    }

                    snapshot.forEach(doc => {
                        const data = doc.data();
                        // Apply filters client-side for complex queries
                        let passesFilter = true;
                        
                        if (filters.location && !data.location.toLowerCase().includes(filters.location.toLowerCase())) {
                            passesFilter = false;
                        }
                        if (filters.type && data.type !== filters.type) {
                            passesFilter = false;
                        }
                        if (filters.maxPrice && data.rent > Number(filters.maxPrice)) {
                            passesFilter = false;
                        }
                        
                        if (passesFilter) {
                            properties.push({
                                id: doc.id,
                                ...data
                            });
                        }
                    });

                    // If we filtered out all results, try to get more
                    if (properties.length === 0 && startAfter) {
                        return await this.getProperties(filters, startAfter, limit * 2);
                    }

                    return properties;
                } catch (error) {
                    console.error('Get properties error:', error);
                    
                    // If index error, use client-side filtering
                    if (error.code === 'failed-precondition' || error.code === 'unavailable') {
                        console.log('Using fallback query due to index issue');
                        return await this.getPropertiesFallback(filters, limit);
                    }
                    
                    throw error;
                }
            }


            static async getUserProperties(userId, startAfter = null, limit = 10) {
                try {
                    let query = db.collection('properties')
                        .where('ownerId', '==', userId);

                    // Try to order by createdAt if index exists
                    try {
                        query = query.orderBy('createdAt', 'desc');
                    } catch (error) {
                        console.log('CreatedAt index not available, skipping order');
                    }

                    query = query.limit(limit);

                    if (startAfter) {
                        query = query.startAfter(startAfter);
                    }

                    const snapshot = await query.get();
                    const properties = [];
                    
                    snapshot.forEach(doc => {
                        properties.push({
                            id: doc.id,
                            ...doc.data()
                        });
                    });

                    // Sort client-side if needed
                    if (properties.length > 0 && !properties[0].createdAt) {
                        properties.sort((a, b) => {
                            const dateA = a.createdAt?.toDate?.() || new Date(0);
                            const dateB = b.createdAt?.toDate?.() || new Date(0);
                            return dateB.getTime() - dateA.getTime();
                        });
                    }

                    return properties;
                } catch (error) {
                    console.error('Get user properties error:', error);
                    return [];
                }
            }

            static async getPropertiesFallback(filters = {}, limit = 6) {
                try {
                    // Get all active properties and filter client-side
                    const snapshot = await db.collection('properties')
                        .where('status', '==', 'active')
                        .limit(50) // Limit to prevent huge reads
                        .get();

                    const properties = [];
                    
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        
                        // Apply all filters client-side
                        let passesFilter = true;
                        
                        if (filters.location && !data.location.toLowerCase().includes(filters.location.toLowerCase())) {
                            passesFilter = false;
                        }
                        if (filters.type && data.type !== filters.type) {
                            passesFilter = false;
                        }
                        if (filters.maxPrice && data.rent > Number(filters.maxPrice)) {
                            passesFilter = false;
                        }
                        
                        if (passesFilter) {
                            properties.push({
                                id: doc.id,
                                ...data
                            });
                        }
                    });

                    // Sort by createdAt client-side
                    properties.sort((a, b) => {
                        const dateA = a.createdAt?.toDate?.() || new Date(0);
                        const dateB = b.createdAt?.toDate?.() || new Date(0);
                        return dateB.getTime() - dateA.getTime();
                    });

                    // Apply limit
                    return properties.slice(0, limit);

                } catch (error) {
                    console.error('Fallback query error:', error);
                    return [];
                }
            }

            static async getPropertiesAlternative(filters = {}, startAfter = null, limit = 6) {
                    try {
                        // Get all properties and filter client-side
                        let query = db.collection('properties')
                            .orderBy('createdAt', 'desc')
                            .limit(limit * 3); // Get more to account for filtering

                        if (startAfter) {
                            query = query.startAfter(startAfter);
                        }

                        const snapshot = await query.get();
                        const properties = [];
                        
                        snapshot.forEach(doc => {
                            const data = doc.data();
                            // Filter manually
                            if (data.status !== 'active') return;
                            if (filters.location && !data.location.includes(filters.location)) return;
                            if (filters.type && data.type !== filters.type) return;
                            if (filters.maxPrice && data.rent > Number(filters.maxPrice)) return;
                            
                            properties.push({
                                id: doc.id,
                                ...data
                            });
                            
                            // Stop if we have enough properties after filtering
                            if (properties.length >= limit) return;
                        });

                        // Store the last document for pagination
                        if (snapshot.docs.length > 0) {
                            state.lastVisible = snapshot.docs[snapshot.docs.length - 1];
                        } else {
                            state.lastVisible = null;
                        }
                        
                        return properties.slice(0, limit);
                    } catch (error) {
                        console.error('Alternative get properties error:', error);
                        return []; // Return empty array instead of throwing
                    }
                }

            static async getPropertyById(id) {
                try {
                    const doc = await db.collection('properties').doc(id).get();
                    if (!doc.exists) {
                        throw new Error('Property not found');
                    }
                    
                    // Increment view count
                    await db.collection('properties').doc(id).update({
                        views: firebase.firestore.FieldValue.increment(1)
                    });

                    return {
                        id: doc.id,
                        ...doc.data()
                    };
                } catch (error) {
                    console.error('Get property error:', error);
                    throw error;
                }
            }

            static async saveProperty(propertyId) {
                try {
                    if (!state.currentUser) {
                        throw new Error('Please login to save properties');
                    }

                    const savedRef = db.collection('savedProperties').doc(`${state.currentUser.uid}_${propertyId}`);
                    const existing = await savedRef.get();

                    if (existing.exists) {
                        await savedRef.delete();
                        state.savedProperties.delete(propertyId);
                        return false; // Unsaved
                    } else {
                        await savedRef.set({
                            userId: state.currentUser.uid,
                            propertyId: propertyId,
                            savedAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        state.savedProperties.add(propertyId);
                        return true; // Saved
                    }
                } catch (error) {
                    console.error('Save property error:', error);
                    throw error;
                }
            }

            static async reportProperty(propertyId, reason, details = '') {
                try {
                    if (!state.currentUser) {
                        throw new Error('Please login to report properties');
                    }

                    // Validate reason
                    if (!reason || reason.trim() === '') {
                        throw new Error('Please select a reason for reporting');
                    }

                    // Check if already reported
                    const existingReport = await db.collection('reports')
                        .where('propertyId', '==', propertyId)
                        .where('userId', '==', state.currentUser.uid)
                        .limit(1)
                        .get();

                    if (!existingReport.empty) {
                        throw new Error('You have already reported this property');
                    }

                    // Create report
                    await db.collection('reports').add({
                        propertyId: propertyId,
                        userId: state.currentUser.uid,
                        reason: reason,
                        details: details,
                        status: 'pending',
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });

                    // Increment report count
                    await db.collection('properties').doc(propertyId).update({
                        reports: firebase.firestore.FieldValue.increment(1)
                    });

                    // Check if property should be hidden (3+ reports)
                    const property = await this.getPropertyById(propertyId);
                    if (property.reports + 1 >= 3) {
                        await db.collection('properties').doc(propertyId).update({
                            status: 'under_review',
                            reviewReason: 'Multiple user reports'
                        });

                        // Notify landlord
                        await db.collection('notifications').add({
                            userId: property.ownerId,
                            type: 'property_hidden',
                            title: 'Property Under Review',
                            message: `Your property in ${property.location} has been hidden due to multiple reports.`,
                            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                            read: false
                        });
                    }

                    return true;
                } catch (error) {
                    console.error('Report property error:', error);
                    throw error;
                }
            }

            // In the PropertyManager class, update the contactLandlord method:
static async contactLandlord(property, userMessage = '') {
    try {
        if (!state.currentUser) {
            throw new Error('Please login to contact landlords');
        }

        // Get user data for the message
        const userData = state.userData || {};
        const userName = userData.firstName && userData.lastName 
            ? `${userData.firstName} ${userData.lastName}`
            : 'A potential tenant';

        // Create inquiry record
        await db.collection('inquiries').add({
            propertyId: property.id,
            userId: state.currentUser.uid,
            landlordId: property.ownerId,
            message: userMessage || `Hello, I'm interested in your ${property.type} in ${property.location}.`,
            userName: userName,
            userEmail: state.currentUser.email,
            userPhone: userData.phone || 'Not provided',
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
            status: 'pending'
        });

        // Increment inquiry count
        await db.collection('properties').doc(property.id).update({
            inquiries: firebase.firestore.FieldValue.increment(1)
        });

        // Generate detailed WhatsApp message
        const detailedMessage = this.generateDetailedMessage(property, userName, userMessage);
        const whatsappMessage = encodeURIComponent(detailedMessage);
        const whatsappNumber = property.whatsapp.startsWith('+') ? property.whatsapp : `+${property.whatsapp}`;
        
        return `https://wa.me/${whatsappNumber}?text=${whatsappMessage}`;
    } catch (error) {
        console.error('Contact landlord error:', error);
        throw error;
    }
}

// Add this new method to generate detailed messages
static generateDetailedMessage(property, userName, customMessage = '') {
    const propertyInfo = `
*PROPERTY DETAILS:*
â€¢ Listing ID: ${property.id}
â€¢ Type: ${property.type}
â€¢ Location: ${property.location}
â€¢ Rent: â‚¦${property.rent?.toLocaleString() || '0'}/${property.frequency || 'month'}
â€¢ Bedrooms: ${property.bedrooms || 'Not specified'}
â€¢ Bathrooms: ${property.bathrooms || 'Not specified'}
${property.description ? `â€¢ Description: ${property.description.substring(0, 100)}...` : ''}
    `.trim();

    const userInfo = `
*MY INFORMATION:*
â€¢ Name: ${userName}
â€¢ Source: DirectLandlord Platform
    `.trim();

    const inquiryMessage = customMessage || `
Hello! I saw your property listing on DirectLandlord and I'm very interested. 

${propertyInfo}

${userInfo}

I would like to:
1. Schedule a viewing
2. Ask a few questions about the property
3. Discuss availability

Please let me know the best time to connect. Looking forward to hearing from you!
    `.trim();

    return inquiryMessage;
}

            static async getUserSavedProperties() {
                try {
                    if (!state.currentUser) return new Set();
                    
                    const snapshot = await db.collection('savedProperties')
                        .where('userId', '==', state.currentUser.uid)
                        .get();
                    
                    const saved = new Set();
                    snapshot.forEach(doc => {
                        saved.add(doc.data().propertyId);
                    });
                    
                    return saved;
                } catch (error) {
                    console.error('Get saved properties error:', error);
                    return new Set();
                }
            }
        }

        // ==================== STATS MANAGER ====================
        class StatsManager {
            static async getStats() {
                try {
                    // Get properties count
                    const propertiesQuery = await db.collection('properties')
                        .where('status', '==', 'active')
                        .get();
                    const totalProperties = propertiesQuery.size;
                    
                    // Get users count
                    const usersQuery = await db.collection('users').get();
                    const totalUsers = usersQuery.size;
                    
                    // Get landlords count
                    const landlordsQuery = await db.collection('users')
                        .where('role', '==', 'landlord')
                        .get();
                    const verifiedLandlords = landlordsQuery.size;

                    return {
                        totalProperties,
                        totalUsers,
                        verifiedLandlords
                    };
                } catch (error) {
                    console.error('Get stats error:', error);
                    
                    // Return fallback stats if there's an error
                    return {
                        totalProperties: 1254,
                        totalUsers: 5892,
                        verifiedLandlords: 347
                    };
                }
            }

            static async updateStatsDisplay() {
                try {
                    const stats = await this.getStats();
                    
                    // Update DOM elements with proper fallback
                    const totalEl = document.getElementById('totalProperties');
                    const landlordsEl = document.getElementById('verifiedLandlords');
                    const usersEl = document.getElementById('activeUsers');
                    
                    if (totalEl) totalEl.textContent = stats.totalProperties.toLocaleString();
                    if (landlordsEl) landlordsEl.textContent = stats.verifiedLandlords.toLocaleString();
                    if (usersEl) usersEl.textContent = stats.totalUsers.toLocaleString();
                } catch (error) {
                    console.error('Update stats display error:', error);
                    
                    // Set fallback values
                    const totalEl = document.getElementById('totalProperties');
                    const landlordsEl = document.getElementById('verifiedLandlords');
                    const usersEl = document.getElementById('activeUsers');
                    
                    if (totalEl) totalEl.textContent = '1,254';
                    if (landlordsEl) landlordsEl.textContent = '347';
                    if (usersEl) usersEl.textContent = '5,892';
                }
            }
        }

        // ==================== UI MANAGER ====================
        class UIManager {

            // In your UIManager class, add this method:
            static updatePageSEO(title, description, url) {
            // Update meta tags
            document.title = `${title} | DirectLandlord`;
            
            // Update meta description
            let metaDesc = document.querySelector('meta[name="description"]');
            if (!metaDesc) {
                metaDesc = document.createElement('meta');
                metaDesc.name = 'description';
                document.head.appendChild(metaDesc);
            }
            metaDesc.content = description;
            
            // Update canonical URL
            let canonical = document.querySelector('link[rel="canonical"]');
            if (!canonical) {
                canonical = document.createElement('link');
                canonical.rel = 'canonical';
                document.head.appendChild(canonical);
            }
            canonical.href = `https://directlandlord.com${url}`;
            
            // Update Open Graph
            document.querySelector('meta[property="og:title"]').content = title;
            document.querySelector('meta[property="og:description"]').content = description;
            document.querySelector('meta[property="og:url"]').content = canonical.href;
            }

            // Call this whenever page content changes:
            // Example for property details:
            async showPropertyDetails(propertyId) {
            const property = await PropertyManager.getPropertyById(propertyId);
            
            // Update SEO for this property
            this.updatePageSEO(
                `${property.type} in ${property.location} - â‚¦${property.rent}/${property.frequency}`,
                `Find ${property.type} for rent in ${property.location}. ${property.description.substring(0, 155)}...`,
                `/property/${propertyId}`
            );
            
            // ... rest of your method
            }
            static init() {
                this.setupEventListeners();
                this.setupAuthState();
                this.loadProperties();
                StatsManager.updateStatsDisplay();
                this.setupScrollHeader();
                setupCORSWorkaround();
            }

            // Add this method to UIManager class
            static closeMobileMenu() {
                const navLinks = document.querySelector('.nav-links');
                if (navLinks) {
                    navLinks.classList.remove('show');
                }
            }

            static setupEventListeners() {
                // Navigation
                document.getElementById('homeBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showHome();
                    this.closeMobileMenu();
                });

                document.getElementById('browseBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showHome();
                    this.scrollToProperties();
                    this.closeMobileMenu();
                });

                document.getElementById('listBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showListProperty();
                    this.closeMobileMenu();
                });

                document.getElementById('howItWorksBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showHowItWorks();
                    this.closeMobileMenu();
                });

                document.getElementById('startBrowsingBtn').addEventListener('click', () => {
                    this.scrollToProperties();
                    this.closeMobileMenu();
                });

                document.getElementById('heroListBtn').addEventListener('click', () => {
                    if (state.currentUser && state.userData?.role === 'landlord') {
                        this.showListProperty();
                    } else {
                        this.showLoginModal();
                        Utils.showToast('Please login as a landlord to list properties', 'info');
                    }
                    this.closeMobileMenu(); // ADD THIS LINE
                });

                document.getElementById('loginToContinueBtn').addEventListener('click', () => {
                    this.showLoginModal();
                });

                document.getElementById('signupToContinueBtn').addEventListener('click', () => {
                    this.showSignupModal();
                });

                // Search
                document.getElementById('searchBtn').addEventListener('click', () => {
                    state.filters = {
                        location: document.getElementById('searchLocation').value,
                        type: document.getElementById('searchType').value,
                        maxPrice: document.getElementById('searchPrice').value
                    };
                    state.currentPage = 1;
                    this.loadProperties();
                });

                // Load more
                document.getElementById('loadMoreBtn').addEventListener('click', async () => {
                    await this.loadMoreProperties();
                });

                // Auth modals
                document.querySelectorAll('.close-modal').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const modalId = btn.dataset.modal;
                        this.hideModal(modalId);
                    });
                });

                document.querySelectorAll('.modal').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            this.hideModal(modal.id);
                        }
                    });
                });

                // Auth tabs
                document.querySelectorAll('.auth-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabName = tab.dataset.tab;
                        this.switchAuthTab(tabName);
                    });
                });

                // Forms
                document.getElementById('loginForm').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await this.handleLogin();
                });

                document.getElementById('signupForm').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await this.handleSignup();
                });

                document.getElementById('forgotPasswordLink').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.hideModal('loginModal');
                    this.showModal('forgotPasswordModal');
                });

                document.getElementById('forgotPasswordForm').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await this.handleForgotPassword();
                });

                // Property form
                document.getElementById('imageUpload').addEventListener('click', () => {
                    document.getElementById('propertyImages').click();
                });

                document.getElementById('propertyImages').addEventListener('change', (e) => {
                    this.handleImageUpload(e.target.files);
                });

                document.getElementById('propertyForm').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await this.handleCreateProperty();
                });

                document.getElementById('cancelPropertyBtn').addEventListener('click', () => {
                    this.showHome();
                });

                // Report form
                document.getElementById('reportForm').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await this.handleReportProperty();
                });

                // Escape key to close modals
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        document.querySelectorAll('.modal.show').forEach(modal => {
                            this.hideModal(modal.id);
                        });
                    }
                });

                // Mobile menu
                document.getElementById('mobileMenuBtn').addEventListener('click', () => {
                    const navLinks = document.querySelector('.nav-links');
                    navLinks.classList.toggle('show');
                });
            }


            static async showSavedProperties() {
                try {
                    if (!state.currentUser) {
                        Utils.showToast('Please login to view saved properties', 'info');
                        this.showLoginModal();
                        return;
                    }

                    // First, hide all other sections and show loading state
                    this.hideAllSections();
                    
                    // Get or create saved properties section
                    let savedSection = document.getElementById('savedPropertiesSection');
                    const mainContent = document.getElementById('mainContent');
                    
                    if (!savedSection) {
                        // Create the section
                        savedSection = document.createElement('section');
                        savedSection.id = 'savedPropertiesSection';
                        savedSection.className = 'section';
                        savedSection.innerHTML = `
                            <div class="container">
                                <div class="flex justify-between items-center mb-8">
                                    <div>
                                        <h2 class="section-title text-left mb-2">Saved Properties</h2>
                                        <p class="text-gray-600">Your favorite properties</p>
                                    </div>
                                    <button class="btn btn-outline" id="backToBrowseBtn">
                                        <i class="fas fa-arrow-left"></i> Back to Browse
                                    </button>
                                </div>
                                <div class="properties-grid" id="savedPropertiesGrid">
                                    <div class="empty-state">
                                        <div class="loader mx-auto mb-4"></div>
                                        <h3>Loading Saved Properties...</h3>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        // SAFER: Append to main content (which is a direct child)
                        mainContent.appendChild(savedSection);
                    }
                    
                    // Show the section
                    savedSection.style.display = 'block';
                    
                    // Update navigation
                    this.setActiveNav('savedPropertiesLink');
                    
                    // Load saved properties
                    await this.loadSavedProperties();
                    
                    // Add back button event (only if not already added)
                    const backBtn = document.getElementById('backToBrowseBtn');
                    if (backBtn && !backBtn.hasAttribute('data-listener-added')) {
                        backBtn.setAttribute('data-listener-added', 'true');
                        backBtn.addEventListener('click', () => {
                            this.showHome();
                        });
                    }
                    
                } catch (error) {
                    console.error('Show saved properties error:', error);
                    Utils.showToast('Error loading saved properties', 'error');
                }
            }

            // Add helper method to hide all sections
            static hideAllSections() {
                const sections = [
                    'heroSection', 
                    'searchSection', 
                    'propertiesSection', 
                    'howItWorksSection', 
                    'listPropertySection'
                ];
                
                sections.forEach(id => {
                    const section = document.getElementById(id);
                    if (section) {
                        section.style.display = 'none';
                    }
                });
            }

            // Update renderPropertiesList method if it exists, or create it:
            static renderPropertiesList(properties, gridId) {
                const grid = document.getElementById(gridId);
                
                if (!properties || properties.length === 0) {
                    grid.innerHTML = `
                        <div class="empty-state">
                            <i class="far fa-bookmark text-4xl text-gray-300 mb-4"></i>
                            <h3>No Properties Found</h3>
                            <p>You haven't saved any properties yet.</p>
                            <button class="btn btn-primary mt-4" onclick="UIManager.showHome()">
                                Browse Properties
                            </button>
                        </div>
                    `;
                    return;
                }
                
                // Use your existing renderProperties method with a flag
                if (gridId === 'savedPropertiesGrid') {
                    // Create HTML for saved properties
                    let html = '';
                    properties.forEach(property => {
                        const isSaved = state.savedProperties.has(property.id);
                        const price = Utils.formatPrice(property.rent);
                        const date = Utils.formatDate(property.createdAt);
                        const mainImage = property.images && property.images.length > 0 ? property.images[0] : 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80';
                        
                        html += `
                            <div class="property-card" data-property-id="${property.id}">
                                ${property.isFeatured ? `
                                    <div class="property-badge badge-featured">
                                        <i class="fas fa-star"></i> Featured
                                    </div>
                                ` : property.isVerified ? `
                                    <div class="property-badge badge-verified">
                                        <i class="fas fa-check-circle"></i> Verified
                                    </div>
                                ` : `
                                    <div class="property-badge badge-new">
                                        <i class="fas fa-home"></i> New
                                    </div>
                                `}
                                
                                <div class="property-image-container">
                                    <img src="${mainImage}" 
                                        alt="${property.type} in ${property.location}" 
                                        class="property-image">
                                </div>
                                
                                <div class="property-content">
                                    <div class="property-header">
                                        <div class="property-price">
                                            ${price}<span>/${property.frequency}</span>
                                        </div>
                                        <button class="property-favorite active" 
                                                data-property-id="${property.id}">
                                            <i class="fas fa-heart"></i>
                                        </button>
                                    </div>
                                    
                                    <h3 class="property-title">${property.type} in ${property.location}</h3>
                                    
                                    <div class="property-location">
                                        <i class="fas fa-map-marker-alt"></i>
                                        <span>${property.location}</span>
                                    </div>
                                    
                                    <p class="property-description">
                                        ${property.description.substring(0, 100)}...
                                    </p>
                                    
                                    ${property.bedrooms || property.bathrooms ? `
                                        <div class="property-features">
                                            ${property.bedrooms ? `
                                                <div class="feature">
                                                    <i class="fas fa-bed"></i>
                                                    <span>${property.bedrooms} bed${property.bedrooms !== '1' ? 's' : ''}</span>
                                                </div>
                                            ` : ''}
                                            ${property.bathrooms ? `
                                                <div class="feature">
                                                    <i class="fas fa-bath"></i>
                                                    <span>${property.bathrooms} bath${property.bathrooms !== '1' ? 's' : ''}</span>
                                                </div>
                                            ` : ''}
                                        </div>
                                    ` : ''}
                                    
                                    <div class="property-footer">
                                        <button class="btn btn-primary btn-sm property-contact-btn" 
                                                data-property-id="${property.id}">
                                            <i class="fab fa-whatsapp"></i> Contact
                                        </button>
                                        <div class="property-date">
                                            <i class="far fa-clock"></i> ${date}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    
                    grid.innerHTML = html;
                    
                    // Attach event listeners to the new cards
                    setTimeout(() => this.attachPropertyEventListeners(), 100);
                }
            }

            // Update loadSavedProperties method:
            static async loadSavedProperties() {
                try {
                    const grid = document.getElementById('savedPropertiesGrid');
                    
                    if (!state.currentUser || state.savedProperties.size === 0) {
                        grid.innerHTML = `
                            <div class="empty-state">
                                <i class="far fa-bookmark text-4xl text-gray-300 mb-4"></i>
                                <h3>No Saved Properties</h3>
                                <p>Save properties by clicking the heart icon to see them here.</p>
                                <button class="btn btn-primary mt-4" onclick="UIManager.showHome()">
                                    Browse Properties
                                </button>
                            </div>
                        `;
                        return;
                    }

                    // Fetch saved properties
                    const savedIds = Array.from(state.savedProperties);
                    const properties = [];
                    
                    // Show loading state
                    grid.innerHTML = `
                        <div class="empty-state">
                            <div class="loader mx-auto mb-4"></div>
                            <h3>Loading Saved Properties...</h3>
                        </div>
                    `;
                    
                    // Fetch each property
                    for (const id of savedIds) {
                        try {
                            const property = await PropertyManager.getPropertyById(id);
                            properties.push(property);
                        } catch (error) {
                            console.warn(`Property ${id} no longer exists or was removed`);
                            // Remove from saved list if property doesn't exist
                            state.savedProperties.delete(id);
                        }
                    }

                    // Render the properties
                    this.renderPropertiesList(properties, 'savedPropertiesGrid');
                    
                } catch (error) {
                    console.error('Load saved properties error:', error);
                    const grid = document.getElementById('savedPropertiesGrid');
                    if (grid) {
                        grid.innerHTML = `
                            <div class="empty-state">
                                <i class="fas fa-exclamation-triangle text-4xl text-warning mb-4"></i>
                                <h3>Error Loading Saved Properties</h3>
                                <p>${error.message}</p>
                                <button class="btn btn-primary mt-4" onclick="UIManager.showHome()">
                                    Back to Browse
                                </button>
                            </div>
                        `;
                    }
                }
            }

            static async loadSavedProperties() {
                try {
                    const grid = document.getElementById('savedPropertiesGrid');
                    
                    if (!state.currentUser || state.savedProperties.size === 0) {
                        grid.innerHTML = `
                            <div class="empty-state">
                                <i class="far fa-bookmark text-4xl text-gray-300 mb-4"></i>
                                <h3>No Saved Properties</h3>
                                <p>Save properties by clicking the heart icon to see them here.</p>
                                <button class="btn btn-primary mt-4" onclick="UIManager.showHome()">
                                    Browse Properties
                                </button>
                            </div>
                        `;
                        return;
                    }

                    // Fetch saved properties from Firestore
                    const savedIds = Array.from(state.savedProperties);
                    const properties = [];
                    
                    for (const id of savedIds) {
                        try {
                            const property = await PropertyManager.getPropertyById(id);
                            properties.push(property);
                        } catch (error) {
                            console.error(`Error loading property ${id}:`, error);
                        }
                    }

                    // Render saved properties
                    this.renderPropertiesList(properties, 'savedPropertiesGrid');
                    
                } catch (error) {
                    console.error('Load saved properties error:', error);
                    document.getElementById('savedPropertiesGrid').innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-exclamation-triangle text-4xl text-warning mb-4"></i>
                            <h3>Error Loading Saved Properties</h3>
                            <p>${error.message}</p>
                        </div>
                    `;
                }
            }

            static setActiveSection(sectionId) {
                // Hide all main content sections
                const sections = ['heroSection', 'searchSection', 'propertiesSection', 
                                'howItWorksSection', 'listPropertySection', 'savedPropertiesSection'];
                
                sections.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) {
                        el.style.display = id === sectionId ? 'block' : 'none';
                    }
                });
            }

            static async showMyProperties() {
                try {
                    await this.loadExpiringProperties();
                    await this.loadArchivedProperties();
                    if (!state.currentUser) {
                        this.showLoginModal();
                        Utils.showToast('Please login to view your properties', 'info');
                        return;
                    }

                    if (state.userData?.role !== 'landlord') {
                        Utils.showToast('Landlord access required', 'error');
                        return;
                    }

                    // Close any open modals
                    this.hideModal('loginModal');
                    this.hideModal('propertyDetailsModal');

                    // Show properties section
                    const sections = ['heroSection', 'searchSection', 'propertiesSection', 'howItWorksSection', 'listPropertySection'];
                    sections.forEach(id => {
                        const el = document.getElementById(id);
                        if (el) {
                            el.style.display = id === 'propertiesSection' ? 'block' : 'none';
                        }
                    });

                    this.setActiveNav('listBtn');

                    // Show loading state
                    const grid = document.getElementById('propertiesGrid');
                    const loaderHtml = `
                        <div class="empty-state">
                            <div class="loader mx-auto mb-4"></div>
                            <h3>Loading Your Properties...</h3>
                            <p>Please wait while we fetch your listings.</p>
                        </div>
                    `;
                    grid.innerHTML = loaderHtml;

                    // Fetch user's properties (without createdAt ordering to avoid index error)
                    const snapshot = await db.collection('properties')
                        .where('ownerId', '==', state.currentUser.uid)
                        .get();

                    // Process and sort manually
                    state.properties = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    })).sort((a, b) => {
                        const dateA = a.createdAt?.toDate?.() || new Date(0);
                        const dateB = b.createdAt?.toDate?.() || new Date(0);
                        return dateB.getTime() - dateA.getTime(); // Newest first
                    });

                    // Update section title
                    document.querySelector('.section-title').textContent = 'My Properties';
                    document.querySelector('.section-subtitle').textContent = 'Manage your listed properties';

                    // Hide load more button for "My Properties" view
                    document.getElementById('loadMoreBtn').classList.add('hidden');

                    // Render properties with management actions
                    this.renderProperties();
                    this.attachLandlordManagementListeners();

                    // Scroll to properties
                    this.scrollToProperties();

                } catch (error) {
                    console.error('Show my properties error:', error);
                    const grid = document.getElementById('propertiesGrid');
                    grid.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-exclamation-triangle text-4xl text-warning mb-4"></i>
                            <h3>Error Loading Properties</h3>
                            <p>${error.message}</p>
                            <button class="btn btn-primary mt-4" onclick="UIManager.loadProperties()">
                                Back to Browse
                            </button>
                        </div>
                    `;
                }
            }


            static async loadExpiringProperties() {
                try {
                    const expiring = await PropertyManager.getExpiringProperties();
                    
                    // Add to UI if there are expiring properties
                    if (expiring.length > 0) {
                        const container = document.createElement('div');
                        container.className = 'bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6';
                        container.innerHTML = `
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center gap-3">
                                    <i class="fas fa-clock text-yellow-600 text-xl"></i>
                                    <h3 class="text-lg font-bold">Properties Expiring Soon</h3>
                                </div>
                                <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-semibold">
                                    ${expiring.length} expiring
                                </span>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="expiringPropertiesList">
                                <!-- Will be populated -->
                            </div>
                        `;
                        
                        const propertiesSection = document.getElementById('propertiesSection');
                        if (propertiesSection) {
                            propertiesSection.insertBefore(container, propertiesSection.firstChild);
                        }
                        
                        // Render expiring properties
                        this.renderExpiringProperties(expiring);
                    }
                } catch (error) {
                    console.error('Load expiring properties error:', error);
                }
            }
            
            static async loadArchivedProperties() {
                try {
                    const archived = await PropertyManager.getArchivedProperties();
                    
                    if (archived.length > 0) {
                        // Create archived section after main properties
                        const archivedSection = document.createElement('div');
                        archivedSection.className = 'mt-12';
                        archivedSection.innerHTML = `
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h3 class="text-2xl font-bold">Archived Properties</h3>
                                    <p class="text-gray-600">Properties archived after 14 days. You can renew them.</p>
                                </div>
                                <span class="bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm font-semibold">
                                    ${archived.length} archived
                                </span>
                            </div>
                            <div class="properties-grid" id="archivedPropertiesGrid">
                                <!-- Will be populated -->
                            </div>
                        `;
                        
                        const propertiesSection = document.getElementById('propertiesSection');
                        if (propertiesSection) {
                            propertiesSection.appendChild(archivedSection);
                        }
                        
                        // Render archived properties with renew buttons
                        this.renderArchivedProperties(archived);
                    }
                } catch (error) {
                    console.error('Load archived properties error:', error);
                }
            }
            
            static renderExpiringProperties(properties) {
                const container = document.getElementById('expiringPropertiesList');
                if (!container) return;
                
                container.innerHTML = '';
                
                properties.forEach(property => {
                    const daysLeft = property.expiresAt 
                        ? Math.ceil((property.expiresAt.toDate() - new Date()) / (1000 * 60 * 60 * 24))
                        : 0;
                    
                    const card = document.createElement('div');
                    card.className = 'bg-white p-4 rounded-lg border border-yellow-200 shadow-sm';
                    card.innerHTML = `
                        <div class="flex justify-between items-start mb-3">
                            <div>
                                <h4 class="font-semibold">${property.type} in ${property.location}</h4>
                                <p class="text-sm text-gray-600">Expires in ${daysLeft} days</p>
                            </div>
                            <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs font-semibold">
                                ${daysLeft} days
                            </span>
                        </div>
                        <div class="flex gap-2">
                            <button class="btn btn-primary btn-sm flex-1 renew-now-btn" data-property-id="${property.id}">
                                <i class="fas fa-redo"></i> Renew Now
                            </button>
                            <button class="btn btn-outline btn-sm view-details-btn" data-property-id="${property.id}">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    `;
                    
                    container.appendChild(card);
                });
                
                // Add event listeners
                container.querySelectorAll('.renew-now-btn').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        const propertyId = btn.dataset.propertyId;
                        await this.handleRenewProperty(propertyId);
                    });
                });
            }
            
            static renderArchivedProperties(properties) {
                const container = document.getElementById('archivedPropertiesGrid');
                if (!container) return;
                
                if (properties.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-archive text-4xl text-gray-300 mb-4"></i>
                            <h3>No Archived Properties</h3>
                            <p>Properties will appear here after 14 days if not renewed.</p>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                properties.forEach(property => {
                    const archivedDate = property.archivedAt 
                        ? new Date(property.archivedAt.seconds * 1000).toLocaleDateString()
                        : 'Unknown';
                    
                    html += `
                        <div class="property-card archived">
                            <div class="property-badge" style="background: rgba(107, 114, 128, 0.9);">
                                <i class="fas fa-archive"></i> Archived
                            </div>
                            <div class="property-image-container">
                                <img src="${property.images && property.images.length > 0 ? property.images[0] : 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'}" 
                                    class="property-image">
                            </div>
                            <div class="property-content">
                                <div class="property-header">
                                    <div class="property-price">
                                        â‚¦${property.rent?.toLocaleString() || '0'}<span>/${property.frequency || 'month'}</span>
                                    </div>
                                </div>
                                <h3 class="property-title">${property.type} in ${property.location}</h3>
                                <div class="property-location">
                                    <i class="fas fa-calendar-times"></i>
                                    <span>Archived on ${archivedDate}</span>
                                </div>
                                <p class="property-description">
                                    ${property.description?.substring(0, 100) || 'No description'}...
                                </p>
                                <div class="property-footer">
                                    <button class="btn btn-primary btn-sm renew-archived-btn" data-property-id="${property.id}">
                                        <i class="fas fa-redo"></i> Renew Listing
                                    </button>
                                    <div class="text-xs text-gray-500">
                                        Renewals: ${property.renewalCount || 0}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                
                // Add renew event listeners
                container.querySelectorAll('.renew-archived-btn').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.stopPropagation();
                        const propertyId = btn.dataset.propertyId;
                        await this.handleRenewProperty(propertyId);
                    });
                });
            }
            
            static async handleRenewProperty(propertyId) {
                try {
                    const result = await PropertyManager.renewProperty(propertyId);
                    
                    if (result) {
                        Utils.showToast('Property renewed successfully for another 14 days!', 'success');
                        
                        // Refresh the view
                        setTimeout(() => {
                            this.showMyProperties();
                        }, 1500);
                    }
                } catch (error) {
                    console.error('Renew property error:', error);
                    Utils.showToast('Failed to renew property: ' + error.message, 'error');
                }
            }

            static async updateProperty(propertyId, propertyData) {
                try {
                    // Get existing property to preserve some data
                    const existingProperty = await PropertyManager.getPropertyById(propertyId);
                    
                    // Upload new images if any
                    let imageUrls = existingProperty.images || [];
                    
                    if (propertyData.imageFiles && propertyData.imageFiles.length > 0) {
                        const newImages = await ImageUploadManager.uploadImages(
                            propertyData.imageFiles, 
                            state.currentUser.uid
                        );
                        // Combine new with existing (limit to 5)
                        imageUrls = [...newImages, ...imageUrls].slice(0, 5);
                    }
                    
                    // Update property in Firestore
                    await db.collection('properties').doc(propertyId).update({
                        type: propertyData.type,
                        location: propertyData.location.trim(),
                        rent: Number(propertyData.rent),
                        frequency: propertyData.frequency,
                        description: Utils.sanitizeInput(propertyData.description),
                        whatsapp: propertyData.whatsapp.replace(/\D/g, ''),
                        bedrooms: propertyData.bedrooms || '',
                        bathrooms: propertyData.bathrooms || '',
                        images: imageUrls,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Create audit log
                    await db.collection('auditLogs').add({
                        userId: state.currentUser.uid,
                        action: 'property_update',
                        targetId: propertyId,
                        details: {
                            type: propertyData.type,
                            location: propertyData.location,
                            rent: propertyData.rent,
                            imageCount: imageUrls.length
                        },
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    return propertyId;
                } catch (error) {
                    console.error('Update property error:', error);
                    throw error;
                }
            }



            // Add these methods anywhere in the UIManager class, perhaps after attachPropertyEventListeners()

            static async editProperty(propertyId) {
                try {
                    // Get the property data
                    const property = await PropertyManager.getPropertyById(propertyId);
                    
                    // Show the list property form
                    this.showListProperty();
                    
                    // Pre-fill the form with existing data
                    setTimeout(() => {
                        document.getElementById('propertyType').value = property.type || '';
                        document.getElementById('propertyLocation').value = property.location || '';
                        document.getElementById('propertyRent').value = property.rent || '';
                        document.getElementById('propertyFrequency').value = property.frequency || '';
                        document.getElementById('propertyDescription').value = property.description || '';
                        document.getElementById('whatsappContact').value = property.whatsapp || '';
                        document.getElementById('propertyBedrooms').value = property.bedrooms || '';
                        document.getElementById('propertyBathrooms').value = property.bathrooms || '';
                        
                        // Store the property ID for updating (CORRECT FIELD NAME)
                        document.getElementById('propertyForm').dataset.editingId = propertyId;
                        
                        // Change submit button text
                        const submitBtn = document.getElementById('submitPropertyBtn');
                        submitBtn.querySelector('.btn-text').textContent = 'Update Property';
                        submitBtn.dataset.mode = 'update';
                        
                        Utils.showToast('Editing property. Update your details below.', 'info');
                    }, 100);
                    
                } catch (error) {
                    console.error('Edit property error:', error);
                    Utils.showToast('Error loading property for editing: ' + error.message, 'error');
                }
            }

            static async showPropertyStats(propertyId) {
                try {
                    const property = await PropertyManager.getPropertyById(propertyId);
                    
                    const modalContent = `
                        <div class="p-4">
                            <div class="bg-gray-50 rounded-lg p-6 mb-6">
                                <h4 class="text-xl font-bold mb-4">Property Stats: ${property.type} in ${property.location}</h4>
                                
                                <div class="grid grid-cols-2 gap-4 mb-6">
                                    <div class="bg-white p-4 rounded-lg border">
                                        <div class="text-2xl font-bold text-primary">${property.views || 0}</div>
                                        <div class="text-sm text-gray-600">Total Views</div>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg border">
                                        <div class="text-2xl font-bold text-primary">${property.inquiries || 0}</div>
                                        <div class="text-sm text-gray-600">Inquiries</div>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg border">
                                        <div class="text-2xl font-bold ${property.reports > 0 ? 'text-warning' : 'text-success'}">${property.reports || 0}</div>
                                        <div class="text-sm text-gray-600">Reports</div>
                                    </div>
                                    <div class="bg-white p-4 rounded-lg border">
                                        <div class="text-2xl font-bold ${property.status === 'active' ? 'text-success' : 'text-warning'}">
                                            ${property.status === 'active' ? 'Active' : 'Inactive'}
                                        </div>
                                        <div class="text-sm text-gray-600">Status</div>
                                    </div>
                                </div>
                                
                                <div class="text-sm text-gray-600">
                                    <div class="mb-2"><i class="fas fa-calendar mr-2"></i> Listed: ${Utils.formatDate(property.createdAt)}</div>
                                    <div class="mb-2"><i class="fas fa-sync-alt mr-2"></i> Last Updated: ${Utils.formatDate(property.updatedAt)}</div>
                                    <div><i class="fas fa-${property.isVerified ? 'check-circle text-success' : 'clock text-warning'} mr-2"></i> 
                                        Verification: ${property.isVerified ? 'Verified' : 'Pending'}
                                    </div>
                                </div>
                            </div>
                            
                            <div class="text-center">
                                <button class="btn btn-primary" id="testContactBtn">
                                    <i class="fab fa-whatsapp"></i> Test Contact Link
                                </button>
                            </div>
                        </div>
                    `;
                    
                    document.getElementById('propertyModalTitle').textContent = 'Property Statistics';
                    document.getElementById('propertyModalContent').innerHTML = modalContent;
                    
                    // Add event listener for test contact button
                    setTimeout(() => {
                        const testBtn = document.getElementById('testContactBtn');
                        if (testBtn) {
                            testBtn.addEventListener('click', () => {
                                this.contactLandlord(propertyId);
                            });
                        }
                    }, 100);
                    
                    this.showModal('propertyDetailsModal');
                    
                } catch (error) {
                    Utils.showToast('Error loading stats: ' + error.message, 'error');
                }
            }

            static async deleteProperty(propertyId) {
                const confirmDelete = confirm('Are you sure you want to delete this property? This action cannot be undone.');
                
                if (!confirmDelete) return;
                
                try {
                    const submitBtn = document.querySelector(`.property-delete-btn[data-property-id="${propertyId}"]`);
                    const originalHtml = submitBtn.innerHTML;
                    submitBtn.innerHTML = '<div class="loader"></div>';
                    submitBtn.disabled = true;
                    
                    // Delete property from Firestore
                    await db.collection('properties').doc(propertyId).delete();
                    
                    // Remove from UI
                    const propertyCard = document.querySelector(`.property-card[data-property-id="${propertyId}"]`);
                    if (propertyCard) {
                        propertyCard.style.opacity = '0.5';
                        setTimeout(() => {
                            propertyCard.remove();
                            // Check if empty
                            if (document.querySelectorAll('.property-card').length === 0) {
                                document.getElementById('propertiesGrid').innerHTML = `
                                    <div class="empty-state">
                                        <i class="fas fa-home text-4xl text-gray-300 mb-4"></i>
                                        <h3>No Properties</h3>
                                        <p>You haven't listed any properties yet.</p>
                                        <button class="btn btn-primary mt-4" onclick="UIManager.showListProperty()">
                                            <i class="fas fa-plus-circle"></i> List Your First Property
                                        </button>
                                    </div>
                                `;
                            }
                        }, 300);
                    }
                    
                    Utils.showToast('Property deleted successfully', 'success');
                    
                } catch (error) {
                    console.error('Delete property error:', error);
                    Utils.showToast('Error deleting property: ' + error.message, 'error');
                }
            }

            static async contactLandlord(propertyId) {
                try {
                    const property = await PropertyManager.getPropertyById(propertyId);
                    const whatsappUrl = await PropertyManager.contactLandlord(property);
                    
                    window.open(whatsappUrl, '_blank');
                    Utils.showToast('Opening WhatsApp to contact landlord', 'success');
                    
                    // Close modal if open
                    this.hideModal('propertyDetailsModal');
                } catch (error) {
                    Utils.showToast(error.message, 'error');
                }
            }

            static showSettingsModal() {
                if (!state.currentUser) {
                    Utils.showToast('Please login to access settings', 'warning');
                    return;
                }
                
                // Populate form fields with current user data
                this.populateSettingsForm();
                
                // Load current notification preferences
                this.loadNotificationPreferences();
                
                // Clear password fields
                this.clearSecurityForm();
                
                // Setup event listeners
                this.setupSettingsEventListeners();
                
                // Ensure we're on profile tab
                this.switchSettingsTab('profile');
                
                this.showModal('settingsModal');
            }

            static populateSettingsForm() {
                if (!state.currentUser || !state.userData) return;
                
                // Text fields
                document.getElementById('settingsFirstName').value = state.userData.firstName || '';
                document.getElementById('settingsLastName').value = state.userData.lastName || '';
                document.getElementById('settingsEmail').value = state.currentUser.email || '';
                document.getElementById('settingsPhone').value = state.userData.phone || '';
                document.getElementById('settingsRole').value = state.userData.role === 'landlord' ? 'Landlord' : 'Rent Seeker';
                
                // Profile image
                this.loadProfileImage();
            }

            static loadProfileImage() {
                const profileImageDisplay = document.getElementById('profileImageDisplay');
                const profileInitialsDisplay = document.getElementById('profileInitialsDisplay');
                
                // Check cache first
                const cachedUrl = this.getCachedProfileImage(state.currentUser.uid);
                
                if (state.userData?.avatar) {
                    if (cachedUrl) {
                        // Use cached image immediately
                        profileImageDisplay.src = cachedUrl;
                        profileImageDisplay.classList.add('show');
                        profileInitialsDisplay.classList.add('hidden');
                    }
                    
                    // Then load fresh image
                    const img = new Image();
                    img.onload = () => {
                        profileImageDisplay.src = state.userData.avatar;
                        this.cacheProfileImage(state.currentUser.uid, state.userData.avatar);
                    };
                    img.src = state.userData.avatar;
                    
                } else {
                    // Show initials as before
                    profileImageDisplay.classList.remove('show');
                    profileInitialsDisplay.classList.remove('hidden');
                    const initials = Utils.getAvatarInitials(
                        (state.userData?.firstName || '') + ' ' + (state.userData?.lastName || '')
                    );
                    profileInitialsDisplay.textContent = initials;
                }
            }

            static loadNotificationPreferences() {
                if (state.userData?.notificationPreferences) {
                    const prefs = state.userData.notificationPreferences;
                    document.getElementById('notifyInquiries').checked = prefs.inquiries !== false;
                    document.getElementById('notifyReports').checked = prefs.reports !== false;
                    document.getElementById('notifyAnnouncements').checked = prefs.announcements !== false;
                } else {
                    // Default to all checked
                    document.getElementById('notifyInquiries').checked = true;
                    document.getElementById('notifyReports').checked = true;
                    document.getElementById('notifyAnnouncements').checked = true;
                }
            }

            static clearSecurityForm() {
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmNewPassword').value = '';
                
                Utils.clearAllErrors('securityForm');
                Utils.clearAllErrors('profileForm');
            }

            static setupSettingsEventListeners() {
                // Profile image upload
                document.getElementById('changeProfileImageBtn').addEventListener('click', () => {
                    document.getElementById('profileImageInput').click();
                });
                
                document.getElementById('profileImageInput').addEventListener('change', (e) => {
                    this.handleProfileImageUpload(e.target.files[0]);
                });
                
                document.getElementById('removeProfileImageBtn').addEventListener('click', () => {
                    this.handleRemoveProfileImage();
                });
                
                // Tab switching
                document.querySelectorAll('[data-settings-tab]').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabName = tab.dataset.settingsTab;
                        this.switchSettingsTab(tabName);
                    });
                });
                
                // Form submissions
                document.getElementById('profileForm').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await this.handleUpdateProfile();
                });
                
                document.getElementById('updateNotificationsBtn').addEventListener('click', async () => {
                    await this.handleUpdateNotifications();
                });
                
                document.getElementById('changePasswordBtn').addEventListener('click', async () => {
                    await this.handleChangePassword();
                });
                
                document.getElementById('verifyEmailBtn').addEventListener('click', async () => {
                    await this.handleResendVerification();
                });
            }

            static switchSettingsTab(tabName) {
                // Update tabs
                document.querySelectorAll('[data-settings-tab]').forEach(tab => {
                    tab.classList.toggle('active', tab.dataset.settingsTab === tabName);
                });
                
                // Show correct form
                const forms = ['profileForm', 'notificationsForm', 'securityForm'];
                forms.forEach(formId => {
                    const form = document.getElementById(formId);
                    if (form) {
                        if (formId === `${tabName}Form`) {
                            form.classList.remove('hidden');
                        } else {
                            form.classList.add('hidden');
                        }
                    }
                });
            }

            static async handleUpdateProfile() {
                const submitBtn = document.getElementById('updateProfileBtn');
                const firstName = document.getElementById('settingsFirstName').value;
                const lastName = document.getElementById('settingsLastName').value;
                const phone = document.getElementById('settingsPhone').value;
                
                // Clear previous errors
                Utils.clearAllErrors('profileForm');
                
                // Validate
                const firstNameError = ValidationHelper.validateName(firstName, 'First name');
                const lastNameError = ValidationHelper.validateName(lastName, 'Last name');
                const phoneError = ValidationHelper.validatePhone(phone);
                
                if (firstNameError) Utils.showError('settingsFirstNameError', firstNameError);
                if (lastNameError) Utils.showError('settingsLastNameError', lastNameError);
                if (phoneError) Utils.showError('settingsPhoneError', phoneError);
                
                if (firstNameError || lastNameError || phoneError) return;
                
                try {
                    Utils.showLoader(submitBtn);
                    
                    // Update user profile in Firebase Auth
                    const updates = {
                        displayName: `${firstName} ${lastName}`
                    };
                    
                    // Update photoURL if avatar exists
                    if (state.userData?.avatar) {
                        updates.photoURL = state.userData.avatar;
                    }
                    
                    await state.currentUser.updateProfile(updates);
                    
                    // Update user data in Firestore
                    await db.collection('users').doc(state.currentUser.uid).update({
                        firstName: firstName.trim(),
                        lastName: lastName.trim(),
                        phone: phone.trim(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Update local state
                    state.userData.firstName = firstName.trim();
                    state.userData.lastName = lastName.trim();
                    state.userData.phone = phone.trim();
                    
                    // Update UI
                    this.updateUserMenu();
                    this.loadProfileImage(); // Refresh profile image display
                    
                    Utils.showToast('Profile updated successfully!', 'success');
                } catch (error) {
                    console.error('Update profile error:', error);
                    Utils.showToast('Error updating profile: ' + error.message, 'error');
                } finally {
                    Utils.hideLoader(submitBtn);
                }
            }

            static async handleUpdateNotifications() {
                const submitBtn = document.getElementById('updateNotificationsBtn');
                
                try {
                    Utils.showLoader(submitBtn);
                    
                    const preferences = {
                        inquiries: document.getElementById('notifyInquiries').checked,
                        reports: document.getElementById('notifyReports').checked,
                        announcements: document.getElementById('notifyAnnouncements').checked
                    };
                    
                    await db.collection('users').doc(state.currentUser.uid).update({
                        notificationPreferences: preferences,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Update local state
                    state.userData.notificationPreferences = preferences;
                    
                    Utils.showToast('Notification preferences saved!', 'success');
                } catch (error) {
                    console.error('Update notifications error:', error);
                    Utils.showToast('Error saving preferences', 'error');
                } finally {
                    Utils.hideLoader(submitBtn);
                }
            }

            static async handleChangePassword() {
                const submitBtn = document.getElementById('changePasswordBtn');
                const currentPassword = document.getElementById('currentPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmNewPassword').value;
                
                // Clear previous errors
                Utils.clearAllErrors('securityForm');
                
                // Validate
                if (!currentPassword) {
                    Utils.showError('currentPasswordError', 'Current password is required');
                    return;
                }
                
                const passwordError = ValidationHelper.validatePassword(newPassword);
                if (passwordError) {
                    Utils.showError('newPasswordError', passwordError);
                    return;
                }
                
                if (newPassword !== confirmPassword) {
                    Utils.showError('confirmNewPasswordError', 'Passwords do not match');
                    return;
                }
                
                try {
                    Utils.showLoader(submitBtn);
                    
                    // Re-authenticate user
                    const credential = firebase.auth.EmailAuthProvider.credential(
                        state.currentUser.email,
                        currentPassword
                    );
                    
                    await state.currentUser.reauthenticateWithCredential(credential);
                    
                    // Update password
                    await state.currentUser.updatePassword(newPassword);
                    
                    // Clear form
                    document.getElementById('currentPassword').value = '';
                    document.getElementById('newPassword').value = '';
                    document.getElementById('confirmNewPassword').value = '';
                    
                    Utils.showToast('Password changed successfully!', 'success');
                } catch (error) {
                    console.error('Change password error:', error);
                    
                    if (error.code === 'auth/wrong-password') {
                        Utils.showError('currentPasswordError', 'Current password is incorrect');
                    } else if (error.code === 'auth/weak-password') {
                        Utils.showError('newPasswordError', 'Password is too weak');
                    } else {
                        Utils.showToast('Error changing password: ' + error.message, 'error');
                    }
                } finally {
                    Utils.hideLoader(submitBtn);
                }
            }

            static async handleResendVerification() {
                const submitBtn = document.getElementById('verifyEmailBtn');
                
                try {
                    Utils.showLoader(submitBtn);
                    
                    await state.currentUser.sendEmailVerification();
                    
                    Utils.showToast('Verification email sent! Check your inbox.', 'success');
                } catch (error) {
                    console.error('Resend verification error:', error);
                    Utils.showToast('Error sending verification email', 'error');
                } finally {
                    Utils.hideLoader(submitBtn);
                }
            }


            static async handleProfileImageUpload(file) {
                if (!file) return;
                
                try {
                    // Compress image before upload
                    const compressedFile = await this.compressImage(file, 800, 0.7);
                    
                    const uploadMessage = document.getElementById('profileUploadMessage');
                    const progressBar = document.getElementById('profileUploadProgressBar');
                    const progressContainer = document.getElementById('profileUploadProgress');
                    
                    // Show upload progress
                    progressContainer.classList.remove('hidden');
                    uploadMessage.textContent = 'Uploading image...';
                    uploadMessage.className = 'text-xs text-gray-500';
                    
                    // Create unique filename
                    const timestamp = Date.now();
                    const fileName = `profile_${timestamp}.jpg`;
                    
                    // Upload to Firebase Storage
                    const storageRef = storage.ref()
                        .child('profile_images')
                        .child(state.currentUser.uid)
                        .child(fileName);
                    
                    const metadata = {
                        contentType: 'image/jpeg',
                        customMetadata: {
                            uploadedBy: state.currentUser.uid,
                            uploadedAt: timestamp.toString()
                        }
                    };
                    
                    // Upload the compressed file
                    const uploadTask = storageRef.put(compressedFile, metadata);
                    
                    // Wait for upload to complete
                    const snapshot = await new Promise((resolve, reject) => {
                        uploadTask.on(
                            'state_changed',
                            (snapshot) => {
                                // Update progress
                                const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                                progressBar.style.width = `${progress}%`;
                            },
                            (error) => {
                                reject(error);
                            },
                            () => {
                                resolve(uploadTask.snapshot);
                            }
                        );
                    });
                    
                    // Get download URL
                    const downloadURL = await storageRef.getDownloadURL();
                    
                    // Cache the image
                    this.cacheProfileImage(state.currentUser.uid, downloadURL);
                    
                    // Update user document in Firestore
                    await db.collection('users').doc(state.currentUser.uid).update({
                        avatar: downloadURL,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Update local state
                    state.userData.avatar = downloadURL;
                    
                    // Update UI
                    this.loadProfileImage();
                    
                    // Show success message
                    uploadMessage.textContent = 'Profile image uploaded successfully!';
                    uploadMessage.classList.add('success');
                    
                    // Update user menu (to show new avatar)
                    this.updateUserMenu();
                    
                    // Hide progress bar after delay
                    setTimeout(() => {
                        progressContainer.classList.add('hidden');
                        progressBar.style.width = '0%';
                        uploadMessage.textContent = '';
                    }, 3000);
                    
                    Utils.showToast('Profile image updated!', 'success');
                    
                } catch (error) {
                    console.error('Profile image upload error:', error);
                    
                    const uploadMessage = document.getElementById('profileUploadMessage');
                    uploadMessage.textContent = 'Upload failed. Please try again.';
                    uploadMessage.classList.add('error');
                    
                    Utils.showToast('Failed to upload profile image', 'error');
                }
            }

            static async handleRemoveProfileImage() {
                if (!state.userData?.avatar) return;
                
                try {
                    // Show confirmation
                    const confirmed = confirm('Are you sure you want to remove your profile image?');
                    if (!confirmed) return;
                    
                    // Delete from Firebase Storage
                    const imageUrl = state.userData.avatar;
                    const success = await ImageUploadManager.deleteImage(imageUrl);
                    
                    if (!success) {
                        console.warn('Could not delete image from storage, but will remove from database');
                    }
                    
                    // Update user document in Firestore
                    await db.collection('users').doc(state.currentUser.uid).update({
                        avatar: firebase.firestore.FieldValue.delete(),
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Update local state
                    delete state.userData.avatar;
                    
                    // Update UI
                    this.loadProfileImage();
                    
                    // Update user menu
                    this.updateUserMenu();
                    
                    Utils.showToast('Profile image removed', 'info');
                    
                } catch (error) {
                    console.error('Remove profile image error:', error);
                    Utils.showToast('Failed to remove profile image', 'error');
                }
            }

            static attachLandlordManagementListeners() {
                // Add edit button to each property card
                document.querySelectorAll('.property-card').forEach(card => {
                    const propertyId = card.dataset.propertyId;
                    const footer = card.querySelector('.property-footer');
                    
                    if (footer) {
                        footer.innerHTML = `
                            <div class="flex gap-2">
                                <button class="btn btn-primary btn-sm property-edit-btn" 
                                        data-property-id="${propertyId}">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-outline btn-sm property-stats-btn" 
                                        data-property-id="${propertyId}">
                                    <i class="fas fa-chart-bar"></i> Stats
                                </button>
                                <button class="btn btn-danger btn-sm property-delete-btn" 
                                        data-property-id="${propertyId}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                    }
                });

                // Edit button listeners - Use bind to preserve 'this' context
                document.querySelectorAll('.property-edit-btn').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.stopPropagation();
                        const propertyId = btn.dataset.propertyId;
                        await UIManager.editProperty(propertyId); // Use UIManager directly
                    });
                });

                // Stats button listeners
                document.querySelectorAll('.property-stats-btn').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.stopPropagation();
                        const propertyId = btn.dataset.propertyId;
                        await UIManager.showPropertyStats(propertyId); // Use UIManager directly
                    });
                });

                // Delete button listeners
                document.querySelectorAll('.property-delete-btn').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.stopPropagation();
                        const propertyId = btn.dataset.propertyId;
                        await UIManager.deleteProperty(propertyId); // Use UIManager directly
                    });
                });
            }

            static setupAuthState() {
                auth.onAuthStateChanged(async (user) => {
                    if (user) {
                        state.currentUser = user;
                        
                        try {
                            // Check email verification
                            await user.reload();
                            if (!user.emailVerified) {
                                Utils.showToast('Please verify your email to access all features', 'warning');
                            }
                            
                            // Get user data
                            const doc = await db.collection('users').doc(user.uid).get();
                            if (doc.exists) {
                                state.userData = doc.data();
                                
                                // Get saved properties
                                state.savedProperties = await PropertyManager.getUserSavedProperties();
                                
                                // Update UI
                                this.updateUserMenu();
                                
                                if (state.userData.role === 'landlord') {
                                    document.getElementById('propertyForm').classList.remove('hidden');
                                    document.getElementById('listPropertyLoginPrompt').classList.add('hidden');
                                }
                                
                                Utils.showToast(`Welcome back, ${state.userData.firstName}!`, 'success');
                            }
                        } catch (error) {
                            console.error('Error loading user data:', error);
                        }
                    } else {
                        state.currentUser = null;
                        state.userData = null;
                        state.savedProperties.clear();
                        this.updateUserMenu();
                        
                        // Reset list property form
                        document.getElementById('propertyForm').classList.add('hidden');
                        document.getElementById('listPropertyLoginPrompt').classList.remove('hidden');
                    }
                });
            }

            static updateUserMenu() {
                const userMenu = document.getElementById('userMenu');
                
                if (state.currentUser && state.userData) {
                    const initials = Utils.getAvatarInitials(state.userData.firstName + ' ' + state.userData.lastName);
                    
                    userMenu.innerHTML = `
                        <div class="user-menu">
                            <button class="user-btn" id="userMenuBtn">
                                <div class="user-avatar">
                                    ${state.userData?.avatar ? 
                                        `<img src="${state.userData.avatar}" alt="${initials}" class="w-full h-full rounded-full object-cover">` : 
                                        initials
                                    }
                                </div>
                                <div class="flex flex-col items-start">
                                    <span class="user-name">${state.userData.firstName}</span>
                                    <span class="text-xs text-gray-500">${state.userData.role}</span>
                                </div>
                                <i class="fas fa-chevron-down text-gray-400"></i>
                            </button>
                            <div class="dropdown" id="userDropdown">
                                <div class="dropdown-item">
                                    <i class="fas fa-user"></i>
                                    <span>${state.userData.firstName} ${state.userData.lastName}</span>
                                </div>
                                <div class="dropdown-item">
                                    <i class="fas fa-${state.userData.role === 'landlord' ? 'home' : 'search'}"></i>
                                    <span>${state.userData.role === 'landlord' ? 'Landlord' : 'Rent Seeker'}</span>
                                </div>
                                <div class="dropdown-item">
                                    <i class="fas fa-envelope"></i>
                                    <span>${state.currentUser.email}</span>
                                </div>
                                <hr>
                                ${state.userData.role === 'landlord' ? `
                                    <a href="#" class="dropdown-item" id="myPropertiesLink">
                                        <i class="fas fa-list"></i> My Properties
                                    </a>
                                ` : ''}
                                <a href="#" class="dropdown-item" id="savedPropertiesLink">
                                    <i class="fas fa-bookmark"></i> Saved Properties
                                </a>
                                <a href="#" class="dropdown-item" id="settingsLink">
                                    <i class="fas fa-cog"></i> Settings
                                </a>
                                <hr>
                                ${state.userData?.isAdmin ? `
                                    <a href="admin.html" class="dropdown-item" target="_blank">
                                        <i class="fas fa-crown"></i> Admin Panel
                                    </a>
                                    <hr>
                                ` : ''}
                                <a href="#" class="dropdown-item text-danger" id="logoutLink">
                                    <i class="fas fa-sign-out-alt"></i> Logout
                                </a>
                            </div>
                        </div>
                    `;
                    
                    // Add dropdown event listeners
                    const userMenuBtn = document.getElementById('userMenuBtn');
                    if (userMenuBtn) {
                        userMenuBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            const dropdown = document.getElementById('userDropdown');
                            if (dropdown) {
                                dropdown.classList.toggle('show');
                            }
                        });
                    }
                    
                    const logoutLink = document.getElementById('logoutLink');
                    if (logoutLink) {
                        logoutLink.addEventListener('click', async (e) => {
                            e.preventDefault();
                            await AuthManager.logout();
                            const dropdown = document.getElementById('userDropdown');
                            if (dropdown) {
                                dropdown.classList.remove('show');
                            }
                        });
                    }

                    const settingsLink = document.getElementById('settingsLink');
                    if (settingsLink) {
                        settingsLink.addEventListener('click', (e) => {
                            e.preventDefault();
                            // Close dropdown
                            const dropdown = document.getElementById('userDropdown');
                            if (dropdown) {
                                dropdown.classList.remove('show');
                            }
                            // Show settings modal
                            this.showSettingsModal();
                        });
                    }

                    // Add after the logoutLink event listener
                    const myPropertiesLink = document.getElementById('myPropertiesLink');
                    if (myPropertiesLink) {
                        myPropertiesLink.addEventListener('click', async (e) => {
                            e.preventDefault();
                            const dropdown = document.getElementById('userDropdown');
                            if (dropdown) dropdown.classList.remove('show');
                            await this.showMyProperties();
                        });
                    }

                    // Add inside the if(state.currentUser) block, after creating the user menu HTML:
                    const savedPropertiesLink = document.getElementById('savedPropertiesLink');
                    if (savedPropertiesLink) {
                        savedPropertiesLink.addEventListener('click', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            document.getElementById('userDropdown').classList.remove('show');
                            this.showSavedProperties();
                        });
                    }
                    
                    // Close dropdown when clicking outside
                    document.addEventListener('click', (e) => {
                        if (!e.target.closest('.user-menu')) {
                            const dropdown = document.getElementById('userDropdown');
                            if (dropdown) {
                                dropdown.classList.remove('show');
                            }
                        }
                    });
                } else {
                    userMenu.innerHTML = `
                        <div class="flex gap-2">
                            <button class="btn btn-outline btn-sm" id="loginHeaderBtn">Login</button>
                            <button class="btn btn-primary btn-sm" id="signupHeaderBtn">Sign Up</button>
                        </div>
                    `;
                    
                    document.getElementById('loginHeaderBtn').addEventListener('click', () => {
                        this.showLoginModal();
                    });
                    
                    document.getElementById('signupHeaderBtn').addEventListener('click', () => {
                        this.showSignupModal();
                    });
                }
            }

            static async loadProperties() {
                try {
                    state.isLoading = true;
                    const grid = document.getElementById('propertiesGrid');
                    grid.innerHTML = `
                        <div class="empty-state">
                            <div class="loader mx-auto mb-4"></div>
                            <h3>Loading Properties...</h3>
                            <p>Please wait while we load the latest properties for you.</p>
                        </div>
                    `;

                    state.properties = await PropertyManager.getProperties(state.filters);
                    this.renderProperties();
                } catch (error) {
                    console.error('Load properties error:', error);
                    document.getElementById('propertiesGrid').innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-exclamation-triangle text-4xl text-warning mb-4"></i>
                            <h3>Error Loading Properties</h3>
                            <p>${error.message}</p>
                            <button class="btn btn-primary mt-4" onclick="UIManager.loadProperties()">
                                Try Again
                            </button>
                        </div>
                    `;
                } finally {
                    state.isLoading = false;
                }
            }

            static async loadMoreProperties() {
                if (state.isLoading || !state.lastVisible) return;
                
                try {
                    state.isLoading = true;
                    Utils.showLoader(document.getElementById('loadMoreBtn'));
                    
                    const moreProperties = await PropertyManager.getProperties(
                        state.filters,
                        state.lastVisible
                    );
                    
                    state.properties.push(...moreProperties);
                    this.renderProperties();
                    state.currentPage++;
                } catch (error) {
                    console.error('Load more error:', error);
                    Utils.showToast('No more properties to load', 'info');
                } finally {
                    state.isLoading = false;
                    Utils.hideLoader(document.getElementById('loadMoreBtn'));
                }
            }

            static renderProperties() {
                const grid = document.getElementById('propertiesGrid');
                
                if (state.properties.length === 0) {
                    grid.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-home text-4xl text-gray-300 mb-4"></i>
                            <h3>No Properties Found</h3>
                            <p>Try adjusting your search filters or check back later for new listings.</p>
                        </div>
                    `;
                    document.getElementById('loadMoreBtn').classList.add('hidden');
                    return;
                }
                
                let html = '';
                state.properties.forEach(property => {
                    const isSaved = state.savedProperties.has(property.id);
                    const price = Utils.formatPrice(property.rent);
                    const date = Utils.formatDate(property.createdAt);
                    const mainImage = property.images && property.images.length > 0 ? property.images[0] : 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80';
                    
                    html += `
                        <div class="property-card" data-property-id="${property.id}">
                            ${property.isFeatured ? `
                                <div class="property-badge badge-featured">
                                    <i class="fas fa-star"></i> Featured
                                </div>
                            ` : property.isVerified ? `
                                <div class="property-badge badge-verified">
                                    <i class="fas fa-check-circle"></i> Verified
                                </div>
                            ` : `
                                <div class="property-badge badge-new">
                                    <i class="fas fa-home"></i> New
                                </div>
                            `}
                            
                            <div class="property-image-container">
                                <img src="${mainImage}" 
                                     alt="${property.type} in ${property.location}" 
                                     class="property-image">
                            </div>
                            
                            <div class="property-content">
                                <div class="property-header">
                                    <div class="property-price">
                                        ${price}<span>/${property.frequency}</span>
                                    </div>
                                    <button class="property-favorite ${isSaved ? 'active' : ''}" 
                                            data-property-id="${property.id}">
                                        <i class="${isSaved ? 'fas' : 'far'} fa-heart"></i>
                                    </button>
                                </div>
                                
                                <h3 class="property-title">${property.type} in ${property.location}</h3>
                                
                                <div class="property-location">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>${property.location}</span>
                                </div>
                                
                                <p class="property-description">
                                    ${property.description.substring(0, 100)}...
                                </p>
                                
                                ${property.bedrooms || property.bathrooms ? `
                                    <div class="property-features">
                                        ${property.bedrooms ? `
                                            <div class="feature">
                                                <i class="fas fa-bed"></i>
                                                <span>${property.bedrooms} bed${property.bedrooms !== '1' ? 's' : ''}</span>
                                            </div>
                                        ` : ''}
                                        ${property.bathrooms ? `
                                            <div class="feature">
                                                <i class="fas fa-bath"></i>
                                                <span>${property.bathrooms} bath${property.bathrooms !== '1' ? 's' : ''}</span>
                                            </div>
                                        ` : ''}
                                    </div>
                                ` : ''}
                                
                                <div class="property-footer">
                                    <button class="btn btn-primary btn-sm property-contact-btn" 
                                            data-property-id="${property.id}">
                                        <i class="fab fa-whatsapp"></i> Contact
                                    </button>
                                    <div class="property-date">
                                        <i class="far fa-clock"></i> ${date}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                grid.innerHTML = html;
                document.getElementById('loadMoreBtn').classList.remove('hidden');
                this.attachPropertyEventListeners();
            }

            static changePropertyImage(direction) {
                if (!state.currentPropertyImages || state.currentPropertyImages.length <= 1) return;
                
                const newIndex = (state.currentPropertyImageIndex + direction + state.currentPropertyImages.length) % state.currentPropertyImages.length;
                this.selectPropertyImage(newIndex);
            }

            static selectPropertyImage(index) {
                state.currentPropertyImageIndex = index;
                const mainImg = document.getElementById('mainImage');
                const currentImg = document.getElementById('currentImage');
                const thumbnails = document.querySelectorAll('#propertyThumbnails > div');
                
                if (mainImg) mainImg.src = state.currentPropertyImages[index];
                if (currentImg) currentImg.textContent = index + 1;
                
                // Update thumbnail borders
                thumbnails.forEach((thumb, i) => {
                    thumb.classList.toggle('border-primary', i === index);
                    thumb.classList.toggle('border-transparent', i !== index);
                });
            }

            static attachPropertyEventListeners() {
                // Property card clicks
                document.querySelectorAll('.property-card').forEach(card => {
                    card.addEventListener('click', async (e) => {
                        if (e.target.closest('button')) return;
                        const propertyId = card.dataset.propertyId;
                        await this.showPropertyDetails(propertyId);
                    });
                });

                // Favorite buttons
                document.querySelectorAll('.property-favorite').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.stopPropagation();
                        const propertyId = btn.dataset.propertyId;
                        await this.toggleFavorite(propertyId, btn);
                    });
                });

                // Contact buttons
                document.querySelectorAll('.property-contact-btn').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        e.stopPropagation();
                        const propertyId = btn.dataset.propertyId;
                        await this.contactLandlord(propertyId);
                    });
                });
            }

            static async showPropertyDetails(propertyId) {
                try {
                    const property = await PropertyManager.getPropertyById(propertyId);
                    const images = property.images || [];
                    const mainImage = images[0] || 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80';
                    
                    // Modern image slider with thumbnail navigation
                    const imageSlider = `
                        <div class="relative group">
                            <!-- Main Image -->
                            <div class="relative h-96 rounded-xl overflow-hidden bg-gray-100">
                                <img id="mainImage" src="${mainImage}" 
                                    alt="${property.type} in ${property.location}"
                                    class="w-full h-full object-cover transition-opacity duration-300">
                                
                                <!-- Navigation Arrows -->
                                ${images.length > 1 ? `
                                    <button class="absolute left-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-white/90 backdrop-blur-sm rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-all duration-300 hover:scale-110" 
                                            onclick="UIManager.changePropertyImage(-1)">
                                        <i class="fas fa-chevron-left text-gray-700"></i>
                                    </button>
                                    <button class="absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 bg-white/90 backdrop-blur-sm rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-all duration-300 hover:scale-110"
                                            onclick="UIManager.changePropertyImage(1)">
                                        <i class="fas fa-chevron-right text-gray-700"></i>
                                    </button>
                                    
                                    <!-- Image Counter -->
                                    <div class="absolute bottom-4 right-4 bg-black/60 backdrop-blur-sm text-white px-3 py-1 rounded-full text-sm">
                                        <span id="currentImage">1</span> / ${images.length}
                                    </div>
                                ` : ''}
                                
                                <!-- Verified Badge -->
                                ${property.isVerified ? `
                                    <div class="absolute top-4 left-4 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg">
                                        <i class="fas fa-check-circle mr-1"></i> Verified
                                    </div>
                                ` : ''}
                            </div>
                            
                            <!-- Thumbnail Strip -->
                            ${images.length > 1 ? `
                                <div class="flex gap-2 mt-4 overflow-x-auto py-2" id="propertyThumbnails">
                                    ${images.map((img, i) => `
                                        <div class="flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden cursor-pointer border-2 ${i === 0 ? 'border-primary' : 'border-transparent'} hover:border-primary transition-all"
                                            onclick="UIManager.selectPropertyImage(${i})">
                                            <img src="${img}" alt="Thumbnail ${i+1}" 
                                                class="w-full h-full object-cover hover:scale-110 transition-transform">
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                    `;
                    
                    // Compact details layout
                    const content = `
                        <div class="space-y-6">
                            <!-- Header with actions -->
                            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                <div>
                                    <h2 class="text-2xl font-bold">${property.type} in ${property.location}</h2>
                                    <div class="flex items-center gap-2 text-gray-600 mt-1">
                                        <i class="fas fa-user"></i>
                                        <span>${property.ownerName}</span>
                                        ${property.isVerified ? `
                                            <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">
                                                Verified Landlord
                                            </span>
                                        ` : ''}
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-3xl font-bold text-primary">
                                        ${Utils.formatPrice(property.rent)}<span class="text-lg text-gray-600">/${property.frequency}</span>
                                    </div>
                                    <div class="text-sm text-gray-500">Listed ${Utils.formatDate(property.createdAt)}</div>
                                </div>
                            </div>
                            
                            <!-- Image Section -->
                            ${imageSlider}
                            
                            <!-- Quick Stats -->
                            <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                                <div class="bg-gray-50 p-4 rounded-xl text-center">
                                    <div class="text-2xl font-bold text-primary">${property.views || 0}</div>
                                    <div class="text-sm text-gray-600">Views</div>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-xl text-center">
                                    <div class="text-2xl font-bold text-primary">${property.inquiries || 0}</div>
                                    <div class="text-sm text-gray-600">Inquiries</div>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-xl text-center">
                                    <div class="text-2xl font-bold text-primary">${property.bedrooms || 'N/A'}</div>
                                    <div class="text-sm text-gray-600">Bedrooms</div>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-xl text-center">
                                    <div class="text-2xl font-bold text-primary">${property.bathrooms || 'N/A'}</div>
                                    <div class="text-sm text-gray-600">Bathrooms</div>
                                </div>
                            </div>
                            
                            <!-- Description -->
                            <div>
                                <h3 class="text-lg font-semibold mb-3">Description</h3>
                                <p class="text-gray-700 whitespace-pre-line leading-relaxed">${property.description}</p>
                            </div>
                            
                            <!-- Quick Actions -->
                            <div class="flex flex-col sm:flex-row gap-3">
                                <button class="btn btn-primary flex-1" id="modalContactBtn">
                                    <i class="fab fa-whatsapp"></i> Contact Landlord
                                </button>
                                ${state.currentUser ? `
                                    <button class="btn btn-outline" id="modalReportBtn">
                                        <i class="fas fa-flag"></i> Report
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    `;
                    
                    // Set modal content
                    document.getElementById('propertyModalTitle').textContent = 'Property Details';
                    document.getElementById('propertyModalContent').innerHTML = content;
                    
                    // Store current images for slider
                    state.currentPropertyImages = images;
                    state.currentPropertyImageIndex = 0;
                    
                    // Attach event listeners
                    document.getElementById('modalContactBtn').addEventListener('click', async () => {
                        await this.contactLandlord(property.id);
                    });
                    
                    if (state.currentUser) {
                        document.getElementById('modalReportBtn').addEventListener('click', () => {
                            this.showReportModal(property.id);
                        });
                    }
                    
                    this.showModal('propertyDetailsModal');
                    
                } catch (error) {
                    console.error('Show property details error:', error);
                    Utils.showToast('Error loading property details', 'error');
                }
            }

            static async toggleFavorite(propertyId, button) {
                try {
                    const isSaved = await PropertyManager.saveProperty(propertyId);
                    
                    if (isSaved) {
                        button.classList.add('active');
                        button.innerHTML = '<i class="fas fa-heart"></i>';
                        Utils.showToast('Property saved to favorites', 'success');
                    } else {
                        button.classList.remove('active');
                        button.innerHTML = '<i class="far fa-heart"></i>';
                        Utils.showToast('Property removed from favorites', 'info');
                    }
                } catch (error) {
                    Utils.showToast(error.message, 'error');
                }
            }

            static async contactLandlord(propertyId) {
                try {
                    const property = await PropertyManager.getPropertyById(propertyId);
                    const whatsappUrl = await PropertyManager.contactLandlord(property);
                    
                    window.open(whatsappUrl, '_blank');
                    Utils.showToast('Opening WhatsApp to contact landlord', 'success');
                    
                    // Close modal if open
                    this.hideModal('propertyDetailsModal');
                } catch (error) {
                    Utils.showToast(error.message, 'error');
                }
            }

            static showReportModal(propertyId) {
                document.getElementById('reportPropertyId').value = propertyId;
                this.showModal('reportModal');
            }

            static async handleReportProperty() {
                const form = document.getElementById('reportForm');
                const submitBtn = document.getElementById('reportSubmitBtn');
                const propertyId = document.getElementById('reportPropertyId').value;
                const reason = document.getElementById('reportReason').value;
                const details = document.getElementById('reportDetails').value;
                
                // Clear previous errors
                Utils.clearAllErrors('reportForm');
                
                try {
                    Utils.showLoader(submitBtn);
                    
                    await PropertyManager.reportProperty(propertyId, reason, details);
                    
                    Utils.showToast('Property reported successfully', 'success');
                    this.hideModal('reportModal');
                    form.reset();
                } catch (error) {
                    // Show specific error
                    if (error.message.includes('Please select')) {
                        Utils.showError('reportReasonError', error.message);
                    } else {
                        Utils.showToast(error.message, 'error');
                    }
                } finally {
                    Utils.hideLoader(submitBtn);
                }
            }

            static handleImageUpload(files) {
                const preview = document.getElementById('imagePreview');
                preview.innerHTML = '';
                
                // Clear previous error
                Utils.hideError('propertyImagesError');
                
                // Validate images
                const error = ValidationHelper.validateImages(files);
                if (error) {
                    Utils.showError('propertyImagesError', error);
                    return;
                }
                
                Array.from(files).slice(0, 5).forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const div = document.createElement('div');
                        div.className = 'preview-image';
                        div.innerHTML = `
                            <img src="${e.target.result}" alt="Preview">
                            <button class="remove-image" type="button">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                        preview.appendChild(div);
                        
                        // Add remove functionality
                        div.querySelector('.remove-image').addEventListener('click', () => {
                            preview.removeChild(div);
                        });
                    };
                    reader.readAsDataURL(file);
                });
            }

            static async handleCreateProperty() {
                const form = document.getElementById('propertyForm');
                const submitBtn = document.getElementById('submitPropertyBtn');
                const formData = {
                    type: document.getElementById('propertyType').value,
                    location: document.getElementById('propertyLocation').value,
                    rent: document.getElementById('propertyRent').value,
                    frequency: document.getElementById('propertyFrequency').value,
                    description: document.getElementById('propertyDescription').value,
                    whatsapp: document.getElementById('whatsappContact').value,
                    bedrooms: document.getElementById('propertyBedrooms').value,
                    bathrooms: document.getElementById('propertyBathrooms').value,
                    imageFiles: document.getElementById('propertyImages').files
                };
                
                // Clear previous errors
                Utils.clearAllErrors('propertyForm');
                
                try {
                    Utils.showLoader(submitBtn);
                    
                    // Check if we're editing or creating
                    const editingId = form.dataset.editingId;
                    const isEditing = submitBtn.dataset.mode === 'update';
                    
                    if (isEditing && editingId) {
                        // UPDATE existing property
                        await this.updateProperty(editingId, formData);
                        Utils.showToast('Property updated successfully!', 'success', 'Update Complete');
                        
                        // Reset edit mode
                        delete form.dataset.editingId;
                        submitBtn.dataset.mode = 'create';
                        submitBtn.querySelector('.btn-text').textContent = 'List Property Now';
                        
                    } else {
                        // CREATE new property
                        const propertyId = await PropertyManager.createProperty(formData);
                        Utils.showToast('Property listed successfully!', 'success', 'Congratulations!');
                    }
                    
                    // Reset form
                    form.reset();
                    document.getElementById('imagePreview').innerHTML = '';
                    
                    // Reload properties to show changes
                    if (state.userData?.role === 'landlord') {
                        await this.showMyProperties();
                    } else {
                        await this.loadProperties();
                    }
                    
                } catch (error) {
                    // Show specific field errors
                    const errors = error.message.split('\n');
                    errors.forEach(err => {
                        if (err.includes('Property type')) {
                            Utils.showError('propertyTypeError', err);
                        } else if (err.includes('Location')) {
                            Utils.showError('propertyLocationError', err);
                        } else if (err.includes('Rent')) {
                            Utils.showError('propertyRentError', err);
                        } else if (err.includes('Payment frequency')) {
                            Utils.showError('propertyFrequencyError', err);
                        } else if (err.includes('Description')) {
                            Utils.showError('propertyDescriptionError', err);
                        } else if (err.includes('WhatsApp')) {
                            Utils.showError('whatsappContactError', err);
                        } else if (err.includes('image')) {
                            Utils.showError('propertyImagesError', err);
                        } else {
                            Utils.showToast(err, 'error', 'Error');
                        }
                    });
                } finally {
                    Utils.hideLoader(submitBtn);
                }
            }

            static async handleLogin() {
                const form = document.getElementById('loginForm');
                const submitBtn = document.getElementById('loginSubmitBtn');
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                
                // Clear previous errors
                Utils.clearAllErrors('loginForm');
                
                try {
                    Utils.showLoader(submitBtn);
                    
                    const user = await AuthManager.login(email, password);
                    
                    // SUCCESS
                    this.hideModal('loginModal');
                    form.reset();
                    Utils.showToast('Login successful!', 'success');
                    
                } catch (error) {
                    // Show specific errors
                    if (error.message.includes('Email')) {
                        Utils.showError('loginEmailError', error.message);
                    } else if (error.message.includes('Password')) {
                        Utils.showError('loginPasswordError', error.message);
                    } else if (error.message.includes('verify')) {
                        Utils.showToast(error.message, 'warning', 'Email Verification Required');
                    } else {
                        Utils.showToast(error.message, 'error');
                    }
                } finally {
                    Utils.hideLoader(submitBtn);
                }
            }

            static async handleSignup() {
                const form = document.getElementById('signupForm');
                const submitBtn = document.getElementById('signupSubmitBtn');
                
                // Clear previous errors
                Utils.clearAllErrors('signupForm');
                
                try {
                    Utils.showLoader(submitBtn);
                    
                    const userData = {
                        firstName: document.getElementById('signupFirstName').value,
                        lastName: document.getElementById('signupLastName').value,
                        email: document.getElementById('signupEmail').value,
                        phone: document.getElementById('signupPhone').value,
                        role: document.getElementById('signupRole').value,
                        password: document.getElementById('signupPassword').value,
                        confirmPassword: document.getElementById('signupConfirmPassword').value,
                        acceptedTerms: document.getElementById('signupTerms').checked
                    };
                    
                    await AuthManager.signup(userData);
                    
                    // SUCCESS
                    this.hideModal('loginModal');
                    form.reset();
                    
                    Utils.showToast(
                        'Account created! Please check your email for verification link.',
                        'success',
                        'Registration Successful'
                    );
                    
                } catch (error) {
                    // Show specific field errors
                    const errors = error.message.split('\n');
                    errors.forEach(err => {
                        if (err.includes('First name')) {
                            Utils.showError('signupFirstNameError', err);
                        } else if (err.includes('Last name')) {
                            Utils.showError('signupLastNameError', err);
                        } else if (err.includes('Email')) {
                            Utils.showError('signupEmailError', err);
                        } else if (err.includes('Phone')) {
                            Utils.showError('signupPhoneError', err);
                        } else if (err.includes('Role')) {
                            Utils.showError('signupRoleError', err);
                        } else if (err.includes('Password')) {
                            Utils.showError('signupPasswordError', err);
                        } else if (err.includes('Passwords do not match')) {
                            Utils.showError('signupConfirmPasswordError', err);
                        } else if (err.includes('Terms')) {
                            Utils.showError('signupTermsError', err);
                        } else {
                            Utils.showToast(err, 'error');
                        }
                    });
                } finally {
                    Utils.hideLoader(submitBtn);
                }
            }

            static async handleForgotPassword() {
                const form = document.getElementById('forgotPasswordForm');
                const submitBtn = document.getElementById('forgotPasswordSubmitBtn');
                const email = document.getElementById('forgotPasswordEmail').value;
                
                // Clear previous errors
                Utils.clearAllErrors('forgotPasswordForm');
                
                try {
                    Utils.showLoader(submitBtn);
                    await AuthManager.resetPassword(email);
                    
                    this.hideModal('forgotPasswordModal');
                    form.reset();
                    
                    Utils.showToast(
                        'Password reset link sent! Check your email.',
                        'success',
                        'Reset Link Sent'
                    );
                } catch (error) {
                    if (error.message.includes('Email')) {
                        Utils.showError('forgotPasswordEmailError', error.message);
                    } else {
                        Utils.showToast(error.message, 'error');
                    }
                } finally {
                    Utils.hideLoader(submitBtn);
                }
            }

            static showModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('show');
                    document.body.style.overflow = 'hidden';
                }
            }

            static hideModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('show');
                    document.body.style.overflow = '';
                }
            }

            static showHome() {
                // Show/Hide sections
                const sections = ['heroSection', 'searchSection', 'propertiesSection', 'howItWorksSection', 'listPropertySection'];
                sections.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) {
                        // Show all sections except listPropertySection and howItWorksSection
                        if (id === 'heroSection' || id === 'searchSection' || id === 'propertiesSection') {
                            el.style.display = 'block';
                        } else {
                            el.style.display = 'none';
                        }
                    }
                });
                
                this.setActiveNav('browseBtn');
                this.setActiveSection('propertiesSection');
            }

            static showListProperty() {
                console.log('showListProperty called');
                
                // Hide all sections that might be visible
                const sectionsToHide = [
                    document.getElementById('heroSection'),
                    document.getElementById('propertiesSection'),
                    document.getElementById('howItWorksSection')
                ];
                
                sectionsToHide.forEach(section => {
                    if (section) section.style.display = 'none';
                });
                
                // Hide the search section (using class selector)
                const searchSection = document.querySelector('.search-section');
                if (searchSection) {
                    searchSection.style.display = 'none';
                    console.log('Search section hidden');
                }
                
                // Show list property section
                const listSection = document.getElementById('listPropertySection');
                if (listSection) {
                    listSection.style.display = 'block';
                    console.log('List section shown');
                }
                
                this.setActiveNav('listBtn');
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            static showHome() {
                console.log('showHome called');
                
                // Show hero section
                const heroSection = document.getElementById('heroSection');
                if (heroSection) heroSection.style.display = 'block';
                
                // Show search section (using class selector)
                const searchSection = document.querySelector('.search-section');
                if (searchSection) {
                    searchSection.style.display = 'block';
                    console.log('Search section shown');
                }
                
                // Show properties section
                const propertiesSection = document.getElementById('propertiesSection');
                if (propertiesSection) propertiesSection.style.display = 'block';
                
                // Hide other sections
                const sectionsToHide = ['howItWorksSection', 'listPropertySection'];
                sectionsToHide.forEach(id => {
                    const section = document.getElementById(id);
                    if (section) section.style.display = 'none';
                });
                
                this.setActiveNav('browseBtn');
                
                // Scroll to properties
                this.scrollToProperties();
            }

            static showHowItWorks() {
                // Show/Hide sections
                const sections = ['heroSection', 'searchSection', 'propertiesSection', 'howItWorksSection', 'listPropertySection'];
                sections.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) {
                        el.style.display = id === 'howItWorksSection' ? 'block' : 'none';
                    }
                });
                
                this.setActiveNav('howItWorksBtn');
                
                // Scroll to section
                const section = document.getElementById('howItWorksSection');
                if (section) {
                    section.scrollIntoView({ behavior: 'smooth' });
                }
            }

            static setActiveNav(activeId) {
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                const activeLink = document.getElementById(activeId);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
            }

            static scrollToProperties() {
                const section = document.getElementById('propertiesSection');
                if (section) {
                    section.scrollIntoView({ behavior: 'smooth' });
                }
            }

            static showLoginModal() {
                this.showModal('loginModal');
                this.switchAuthTab('login');
            }

            static showSignupModal() {
                this.showModal('loginModal');
                this.switchAuthTab('signup');
            }

            static switchAuthTab(tabName) {
                // Update tabs
                document.querySelectorAll('.auth-tab').forEach(tab => {
                    tab.classList.toggle('active', tab.dataset.tab === tabName);
                });
                
                // Show correct form
                const loginForm = document.getElementById('loginForm');
                const signupForm = document.getElementById('signupForm');
                
                if (loginForm && signupForm) {
                    loginForm.classList.toggle('hidden', tabName !== 'login');
                    signupForm.classList.toggle('hidden', tabName !== 'signup');
                }
                
                // Clear errors
                if (tabName === 'login') {
                    Utils.clearAllErrors('signupForm');
                } else {
                    Utils.clearAllErrors('loginForm');
                }
            }

            static setupScrollHeader() {
                window.addEventListener('scroll', () => {
                    const header = document.getElementById('header');
                    if (header) {
                        if (window.scrollY > 50) {
                            header.classList.add('scrolled');
                        } else {
                            header.classList.remove('scrolled');
                        }
                    }
                });
            }

            static cacheProfileImage(userId, imageUrl) {
                try {
                    localStorage.setItem(`profile_img_${userId}`, imageUrl);
                    // Set expiry for 7 days
                    localStorage.setItem(`profile_img_expiry_${userId}`, Date.now() + 7*24*60*60*1000);
                } catch (e) {
                    console.log('Cache failed, localStorage might be full');
                }
            }

            static getCachedProfileImage(userId) {
                try {
                    const expiry = localStorage.getItem(`profile_img_expiry_${userId}`);
                    if (expiry && Date.now() > parseInt(expiry)) {
                        localStorage.removeItem(`profile_img_${userId}`);
                        return null;
                    }
                    return localStorage.getItem(`profile_img_${userId}`);
                } catch (e) {
                    return null;
                }
            }

            static compressImage(file, maxWidth = 800, quality = 0.7) {
                return new Promise((resolve) => {
                    if (!file.type.startsWith('image/')) {
                        resolve(file);
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = new Image();
                        img.onload = () => {
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            
                            // Calculate new dimensions
                            let width = img.width;
                            let height = img.height;
                            
                            if (width > maxWidth) {
                                height = (height * maxWidth) / width;
                                width = maxWidth;
                            }
                            
                            canvas.width = width;
                            canvas.height = height;
                            ctx.drawImage(img, 0, 0, width, height);
                            
                            // Convert to compressed blob
                            canvas.toBlob((blob) => {
                                resolve(new File([blob], file.name, { 
                                    type: 'image/jpeg',
                                    lastModified: Date.now()
                                }));
                            }, 'image/jpeg', quality);
                        };
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                });
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            try {
                UIManager.init();
                console.log('ðŸš€ DirectLandlord Application Initialized');
            } catch (error) {
                console.error('Failed to initialize application:', error);
                Utils.showToast('Application failed to load. Please refresh the page.', 'error');
            }
        });

        // Global error handler
        window.addEventListener('error', (event) => {
            console.error('Global error:', event.error);
            console.error('Error at:', event.filename, 'line', event.lineno);
        });

        // Prevent form resubmission
        if (window.history.replaceState) {
            window.history.replaceState(null, null, window.location.href);
        }

        // Make available globally for debugging
        window.DirectLandlord = {
            app,
            auth,
            db,
            storage,
            state,
            ValidationHelper,
            Utils,
            AuthManager,
            PropertyManager,
            StatsManager,
            UIManager
        };
    </script>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">Account Settings</h3>
                <button class="modal-close close-modal" data-modal="settingsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="tabs mb-6">
                    <div class="auth-tabs">
                        <button class="auth-tab active" data-settings-tab="profile">Profile</button>
                        <button class="auth-tab" data-settings-tab="notifications">Notifications</button>
                        <button class="auth-tab" data-settings-tab="security">Security</button>
                    </div>
                </div>
                
                <!-- Profile Tab -->
                <!-- Profile Tab -->
            <form id="profileForm" class="settings-form">
                <!-- Profile Image Section -->
                <div class="mb-8">
                    <div class="flex items-center gap-6 mb-4">
                        <div class="relative">
                            <div class="w-32 h-32 rounded-full overflow-hidden border-4 border-white shadow-lg" id="profileImageContainer">
                                <img src="" alt="Profile" class="w-full h-full object-cover" id="profileImageDisplay">
                                <div class="w-full h-full bg-gradient-primary flex items-center justify-center text-white text-4xl font-bold" id="profileInitialsDisplay"></div>
                            </div>
                            <button type="button" class="absolute bottom-0 right-0 bg-primary text-white p-2 rounded-full hover:bg-primary-dark transition-colors" id="changeProfileImageBtn">
                                <i class="fas fa-camera"></i>
                            </button>
                            <input type="file" id="profileImageInput" accept="image/*" class="hidden">
                        </div>
                        <div class="flex-1">
                            <h4 class="text-lg font-bold mb-2">Profile Picture</h4>
                            <p class="text-gray-600 mb-4">Upload a clear photo of yourself. Max 5MB. JPG, PNG, or GIF.</p>
                            <div class="upload-progress hidden" id="profileUploadProgress">
                                <div class="upload-progress-bar" id="profileUploadProgressBar"></div>
                            </div>
                            <div class="text-xs text-gray-500" id="profileUploadMessage"></div>
                        </div>
                    </div>
                    
                    <button type="button" class="btn btn-outline btn-sm" id="removeProfileImageBtn" style="display: none;">
                        <i class="fas fa-trash"></i> Remove Photo
                    </button>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">First Name</label>
                        <input type="text" class="form-control" id="settingsFirstName" required>
                        <div class="error-message" id="settingsFirstNameError"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Last Name</label>
                        <input type="text" class="form-control" id="settingsLastName" required>
                        <div class="error-message" id="settingsLastNameError"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="settingsEmail" disabled>
                        <div class="text-xs text-gray-600 mt-2">Email cannot be changed</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Phone Number</label>
                        <input type="tel" class="form-control" id="settingsPhone" required>
                        <div class="error-message" id="settingsPhoneError"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Role</label>
                        <input type="text" class="form-control" id="settingsRole" disabled>
                    </div>
                    
                    <div class="form-group full-width">
                        <button type="submit" class="btn btn-primary" id="updateProfileBtn">
                            <span class="btn-text">Update Profile</span>
                            <div class="loader hidden" id="profileLoader"></div>
                        </button>
                    </div>
                </div>
            </form>
                
                <!-- Notifications Tab -->
                <div id="notificationsForm" class="settings-form hidden">
                    <div class="bg-white rounded-lg border p-6 mb-6">
                        <h4 class="text-lg font-bold mb-4">Notification Preferences</h4>
                        
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-medium">New Inquiry Notifications</div>
                                    <div class="text-sm text-gray-600">Get notified when someone contacts you</div>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="notifyInquiries">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-medium">Report Alerts</div>
                                    <div class="text-sm text-gray-600">Get alerts about reported properties</div>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="notifyReports">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-medium">Announcements</div>
                                    <div class="text-sm text-gray-600">Receive platform updates and news</div>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" id="notifyAnnouncements">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <button class="btn btn-primary" id="updateNotificationsBtn">
                            <span class="btn-text">Save Preferences</span>
                            <div class="loader hidden" id="notificationsLoader"></div>
                        </button>
                    </div>
                </div>
                
                <!-- Security Tab -->
                <div id="securityForm" class="settings-form hidden">
                    <div class="bg-white rounded-lg border p-6 mb-6">
                        <h4 class="text-lg font-bold mb-4">Change Password</h4>
                        
                        <div class="form-group">
                            <label class="form-label">Current Password</label>
                            <input type="password" class="form-control" id="currentPassword">
                            <div class="error-message" id="currentPasswordError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">New Password</label>
                            <input type="password" class="form-control" id="newPassword">
                            <div class="error-message" id="newPasswordError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Confirm New Password</label>
                            <input type="password" class="form-control" id="confirmNewPassword">
                            <div class="error-message" id="confirmNewPasswordError"></div>
                        </div>
                    </div>
                    
                    <div class="flex gap-4">
                        <button class="btn btn-primary" id="changePasswordBtn">
                            <span class="btn-text">Change Password</span>
                            <div class="loader hidden" id="passwordLoader"></div>
                        </button>
                        
                        <button class="btn btn-outline" id="verifyEmailBtn">
                            <span class="btn-text">Resend Verification Email</span>
                            <div class="loader hidden" id="verifyLoader"></div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>